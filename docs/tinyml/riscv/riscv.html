<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>RISCV ISA – TinyML</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../cc-os/cc-os.html" rel="next">
<link href="../c-riscv-asm/c-riscv-asm.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-2fef5ea3f8957b3e4ecc936fc74692ca.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-6353c5142b84b22f6683470407aecb9b.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-5549b3ede58740172b4e45471f64731a.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../site_libs/bootstrap/bootstrap-6353c5142b84b22f6683470407aecb9b.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const queryPrefersDark = window.matchMedia('(prefers-color-scheme: dark)');
    const darkModeDefault = queryPrefersDark.matches;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    queryPrefersDark.addEventListener("change", e => {
      if(window.localStorage.getItem("quarto-color-scheme") !== null)
        return;
      const alternate = e.matches
      toggleColorMode(alternate);
      localAlternateSentinel = e.matches ? 'alternate' : 'default'; // this is used alongside local storage!
      toggleGiscusIfUsed(alternate, darkModeDefault);
    });
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../c-riscv-asm/c-riscv-asm.html">Crash Courses</a></li><li class="breadcrumb-item"><a href="../riscv/riscv.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">RISCV ISA</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">TinyML</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Prologue</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction 引入</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../resources/resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Resources 学习资料汇总</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../glossary/glossary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Glossary 名词解释</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Environment Setup</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../env-setup/env-setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">FPGA 开发环境配置</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Crash Courses</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../c-riscv-asm/c-riscv-asm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">C 和 RISCV 汇编</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../riscv/riscv.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">RISCV ISA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../cc-os/cc-os.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">OS 操作系统原理</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hdl/hdl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">HDL 硬件描述语言</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../cc-fpga/cc-fpga.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">FPGA 原理速成</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../cc-cpu/cc-cpu.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">CPU 原理速成</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../cc-gpu/cc-gpu.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">GPU 原理速成</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../open-src-tools/open-src-tools.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Open Source 开源工具</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Neural Network</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../nn-essence/nn-essence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">The Essence of NN 神经网络的本质</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../yolo/yolo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">YOLO Object Detection 目标检测</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">ML Accelerators</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hls-design/HLS-design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">HLS Design FPGA 并行编程</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">CFU Playground</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../cfu-proj-struct/cfu-proj-struct.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">CFU-Playground 工程结构</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#riscv-extensions" id="toc-riscv-extensions" class="nav-link active" data-scroll-target="#riscv-extensions">RISCV Extensions</a></li>
  <li><a href="#指令类型" id="toc-指令类型" class="nav-link" data-scroll-target="#指令类型">指令类型</a>
  <ul class="collapse">
  <li><a href="#alu-运算" id="toc-alu-运算" class="nav-link" data-scroll-target="#alu-运算">ALU 运算</a></li>
  <li><a href="#csr-寄存器及其操作" id="toc-csr-寄存器及其操作" class="nav-link" data-scroll-target="#csr-寄存器及其操作">CSR 寄存器及其操作</a></li>
  <li><a href="#gprs-通用寄存器" id="toc-gprs-通用寄存器" class="nav-link" data-scroll-target="#gprs-通用寄存器">GPRs 通用寄存器</a></li>
  <li><a href="#跳转指令" id="toc-跳转指令" class="nav-link" data-scroll-target="#跳转指令">跳转指令</a></li>
  <li><a href="#machine-mode" id="toc-machine-mode" class="nav-link" data-scroll-target="#machine-mode">Machine Mode</a></li>
  <li><a href="#内存操作" id="toc-内存操作" class="nav-link" data-scroll-target="#内存操作">内存操作</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../c-riscv-asm/c-riscv-asm.html">Crash Courses</a></li><li class="breadcrumb-item"><a href="../riscv/riscv.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">RISCV ISA</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">RISCV ISA</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<blockquote class="blockquote">
<p>Exported from Notion, may not be well-organized.</p>
</blockquote>
<section id="riscv-extensions" class="level2">
<h2 class="anchored" data-anchor-id="riscv-extensions">RISCV Extensions</h2>
<p>In RISC-V, extensions are optional instruction sets that extend the base ISA (RV32I, 32-bit integer instructions) to add extra functionality.</p>
<p>Some extensions are listed here:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 37%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Extension</th>
<th>Meaning</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>M</td>
<td>Integer Multiplication &amp; Division</td>
<td>Adds mul, div, rem instructions</td>
</tr>
<tr class="even">
<td>A</td>
<td>Atomic Instructions</td>
<td>Adds atomic memory operations (e.g., amoadd.w)</td>
</tr>
<tr class="odd">
<td>F</td>
<td>Single-Precision Floating Point</td>
<td>Supports float (32-bit) operations</td>
</tr>
<tr class="even">
<td>D</td>
<td>Double-Precision Floating Point</td>
<td>Supports double (64-bit) operations</td>
</tr>
<tr class="odd">
<td>C</td>
<td>Compressed Instructions</td>
<td>Reduces code size (e.g., c.add, c.sw)</td>
</tr>
</tbody>
</table>
<p>For example, RV32IMAC → A 32-bit RISC-V CPU with Integer (I), Multiply (M), Atomic (A), and Compressed (C) extensions. RV32IMAFD can be reduced to written as RV32G.</p>
<ul>
<li><code>Zicsr</code>: Z (Standard), I (Integer), CSR (Support read and write to CSRs)</li>
</ul>
</section>
<section id="指令类型" class="level2">
<h2 class="anchored" data-anchor-id="指令类型">指令类型</h2>
<section id="alu-运算" class="level3">
<h3 class="anchored" data-anchor-id="alu-运算">ALU 运算</h3>
<ul>
<li><p>One category of instructions is arithmetic operations (abbr. aluop), which is just doing things between GPRs.</p></li>
<li><p>Commonly Used aluop instructions:</p>
<pre class="assembly"><code>lui t0, 0x40000     ;t0 = 0x40000 &lt;&lt; 12 (load upper 20 bits of the imm)

add t0, t1, t2      ;t0 = t1 + t2
sub t0, t1, t2      ;t0 = t1 - t2 (no imm version)
or t0, t1, t2       ;t0 = t1 | t2
and t0, t1, t2      ;t0 = t1 &amp; t2
xor t0, t1, t2      ;t0 = t1 ^ t2

addi t0, t1, 10     ;t0 = t1 + 10 (decimal)
ori t0, t1, 0xF     ;t0 = t1 | 0xF
andi t0, t1, 0xF    ;t0 = t1 &amp; 0xF
xori t0, t1, 0xF    ;t0 = t1 ^ 0xF

sll t0, t1, t2      ;t0 = t1 &lt;&lt; t2 (shift left logical)
srl t0, t1, t2      ;t0 = t1 &gt;&gt; t2 (shift right logical)
sra t0, t1, t2      ;t0 = t1 &gt;&gt; t2 (shift right arithmetic, preserve sign)

slli t0, t1, 2      ;t0 = t1 &lt;&lt; 2
srli t0, t1, 2      ;t0 = t1 &gt;&gt; 2
srai t0, t1, 2      ;t0 = t1 &gt;&gt; 2 (preserve sign)

slt t0, t1, t2      ;t0 = (t1 &lt; t2) (set if less than signed)
sltu t0, t1, t2     ;t0 = (t1 &lt; t2) (set if less than unsigned)

slti t0, t1, -5     ;t0 = (t1 &lt; -5) (imm signed)
sltiu t0, t1, 10    ;t0 = (t1 &lt; 10) (imm unsigned)</code></pre></li>
</ul>
</section>
<section id="csr-寄存器及其操作" class="level3">
<h3 class="anchored" data-anchor-id="csr-寄存器及其操作">CSR 寄存器及其操作</h3>
<section id="introduction" class="level4">
<h4 class="anchored" data-anchor-id="introduction">Introduction</h4>
<ul>
<li><p>CSR (Control and Status Registers)</p></li>
<li><p>Are accessed using CSR instructions, not via memory-mapped I/O like GPIO registers.</p></li>
<li><p>GPRs can be accessed at any privilege level, while CSRs are defined at a specific privilege level and can only be accessed by that level and any levels of higher privilege.</p></li>
<li><p>Every CSR has a unique address, each 32 bits share one address (instead of 8 bits).</p></li>
<li><p>CSR addresses are 12-bits, meaning that up to 4,096 CSRs can be implemented (<span class="math inline">\(2^12 = 4096\)</span>). The bits in a CSR address define its accessibility, use, and CSR number. <img src="csr-addr-def.png" class="img-fluid" alt="https://danielmangum.com/posts/risc-v-bytes-privilege-levels/"></p></li>
<li><p>While GPRs are used for storing data used to perform operations, CSRs typically modify the behavior of a hart (i.e.&nbsp;“Control”) or inform of its state and attributes (i.e.&nbsp;“Status”), or both.</p></li>
<li><p><code>WARL</code> (Write any, read legal): Some field in a CPU register that allows <strong>any</strong> value to be <strong>written</strong>, but when <strong>read</strong> back, it returns only a <strong>valid (legal)</strong> value. For example, in <code>MPP[12:11]</code> field in <code>mstatus</code> register, we have:</p></li>
</ul>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Write Attempt (MPP)</th>
<th>Stored Value (MPP field)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>00 (User)</td>
<td>✅ 00 (User mode)</td>
</tr>
<tr class="even">
<td>11 (Machine)</td>
<td>✅ 11 (Machine mode)</td>
</tr>
<tr class="odd">
<td>01 (Illegal)</td>
<td>🔄 Returns 00 or 11 (Legal)</td>
</tr>
<tr class="even">
<td>10 (Illegal)</td>
<td>🔄 Returns 00 or 11 (Legal)</td>
</tr>
</tbody>
</table>
<ul>
<li>CSRs related intimitely to interrupts and exceptions (interrupts are external (“asynchronise”), exceptions are internal (“synchronise”, usually through software or timer), some place confuse them though, but it’s okay).</li>
</ul>
</section>
<section id="commonly-used-csrs-and-their-sub-fields" class="level4">
<h4 class="anchored" data-anchor-id="commonly-used-csrs-and-their-sub-fields">Commonly Used CSRs and their sub-fields</h4>
<p>The registers are labelled in this format: <code>reg (addr, reset_val)</code>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="common-csrs.png" class="img-fluid figure-img"></p>
<figcaption>Part of the registers</figcaption>
</figure>
</div>
<ol type="1">
<li><code>mstatus (0x300, 0x00001800)</code>: Machine Status (lower 32 bits), controls global interrupt enable and privilege modes.</li>
</ol>
<ul>
<li><code>mstatus.MPP[12:11]</code>: Machine Previous Priviledge mode. When an mret is executed, the privilege mode is change to this value.</li>
<li><code>mstatus.MIE[3]</code>: Machine (<em>global</em>) Interrupt Enable.</li>
<li><code>mstatus.MPIE[7]</code>: Machine previous Interrupt Enable. When an interrupt occurs, the content in <code>mstatus.MIE</code> is loaded into this bit (and for simplicity, <code>mstatus.MIE</code> is changed to 0, so no other interrupts is allowed to come in), and after the interrupt is processed (after <code>mret</code>), this bit is restored into <code>mstatus.MIE</code> again.</li>
</ul>
<ol start="2" type="1">
<li><p><code>misa (0x301, depends on RV32 and M_EXT)</code>:</p></li>
<li><p><code>mie (0x304, 0x00000000)</code>: Machine Interrupt Enable, enables <em>specific</em> interrupts (not <em>global</em>). Also you should have a look at <code>mip (0x344)</code>.</p></li>
<li><p><code>mip (0x344)</code>: Machine Interrupt Pending Register, indicates which <em>specific</em> interrupts are pending. <img src="mip_mie.png" class="img-fluid" alt="mip and mie"></p>
<ul>
<li><code>MSIP/MSIE[3]</code>: Machine Software Interrupt Pending/Enable</li>
<li><code>MTIP/MTIE[7]</code>: Machine Timer Interrupt Pending/Enable</li>
<li><code>MEIP/MEIE[11]</code>: Machine External Interrupt Pending/Enable</li>
</ul></li>
<li><p><code>mtvec (0x305, )</code>: Machine Trap-Handler Base Address, specifies where the CPU jumps on an interrupt/exception. <img src="mtvec.png" class="img-fluid" alt="mtvec"></p>
<ul>
<li><code>MODE[1:0]</code>:
<ul>
<li>00: Direct. All traps (either interrupts or exceptions) set <code>PC</code> <em>directly</em> to <code>BASE</code>.</li>
<li>01: Vectored. Exceptions will set <code>PC</code> <em>directly</em> to <code>BASE</code>, while (asynchronous) interrupts will set <code>PC</code> to <code>BASE</code>+4*<code>mcause.Exception Code</code> (See <code>mcause</code> register.)</li>
<li>others: invalid.</li>
</ul></li>
</ul></li>
<li><p><code>mepc (0x341, 0x00000000)</code>: Machine Exception Program Counter, saves the address of the interrupted instruction.</p>
<ul>
<li>When an interrupt occurs, the current PC + 1 is saved in <code>mepc</code>.</li>
<li>When an exception is encountered, the current PC is saved in <code>mepc</code>. (Why? The exception may triggered by the instruction at the current PC, maybe we solve the exception in the interrupt handler, so give it another chance to execute that instruction again.)</li>
</ul>
<p>and the core jumps to the exception address. When a <code>mret</code> instruction is executed, the value from <code>mepc</code> replaces the current program counter.</p></li>
<li><p><code>mcause (0x342)</code>: Machine Trap Cause, identifies the cause of the interrupt/exception. <img src="mcause.png" class="img-fluid" alt="mcause"></p>
<ul>
<li><p><code>Interrupt[31]</code>:</p>
<ul>
<li>1: Exceptions</li>
<li>0: Interrupts</li>
</ul></li>
<li><p><code>Exception Code[30:0]</code>: (pay special attention to the number 3/7/11)</p>
<table class="caption-top table">
<colgroup>
<col style="width: 15%">
<col style="width: 31%">
<col style="width: 52%">
</colgroup>
<thead>
<tr class="header">
<th><code>Interrupt[31]</code></th>
<th><code>Exception Code[30:0]</code></th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>0, 2, 4, 6, 8, 10, 12, 14-15</td>
<td><em>Reserved</em></td>
</tr>
<tr class="even">
<td>1</td>
<td>1 / 3</td>
<td>Supervisor/Machine software interrupt</td>
</tr>
<tr class="odd">
<td>1</td>
<td>5 / 7</td>
<td>Supervisor/Machine timer interrupt</td>
</tr>
<tr class="even">
<td>1</td>
<td>9 / 11</td>
<td>Supervisor/Machine external interrupt</td>
</tr>
<tr class="odd">
<td>1</td>
<td>13</td>
<td>Counter-overflow interrupt</td>
</tr>
<tr class="even">
<td>1</td>
<td>≥16</td>
<td><em>Designated for platform use</em></td>
</tr>
<tr class="odd">
<td>0</td>
<td>0</td>
<td>Instruction address misaligned</td>
</tr>
<tr class="even">
<td>0</td>
<td>1</td>
<td>Instruction access fault</td>
</tr>
<tr class="odd">
<td>0</td>
<td>2</td>
<td>Illegal instruction</td>
</tr>
<tr class="even">
<td>0</td>
<td>3</td>
<td>Breakpoint</td>
</tr>
<tr class="odd">
<td>0</td>
<td>4</td>
<td>Load address misaligned</td>
</tr>
<tr class="even">
<td>0</td>
<td>5</td>
<td>Load access fault</td>
</tr>
<tr class="odd">
<td>0</td>
<td>6 / 7</td>
<td>Store/AMO address/access fault</td>
</tr>
<tr class="even">
<td>0</td>
<td>8 / 9 / 11</td>
<td>Environment call from U/S/M-mode</td>
</tr>
<tr class="odd">
<td>0</td>
<td>10, 14, 17, 20-23, 32-47, ≥64</td>
<td><em>Reserved</em></td>
</tr>
<tr class="even">
<td>0</td>
<td>12</td>
<td>Instruction page fault</td>
</tr>
<tr class="odd">
<td>0</td>
<td>13</td>
<td>Load page fault</td>
</tr>
<tr class="even">
<td>0</td>
<td>15</td>
<td>Store/AMO page fault</td>
</tr>
<tr class="odd">
<td>0</td>
<td>16</td>
<td>Double trap</td>
</tr>
<tr class="even">
<td>0</td>
<td>18</td>
<td>Software check</td>
</tr>
<tr class="odd">
<td>0</td>
<td>19</td>
<td>Hardware error</td>
</tr>
<tr class="even">
<td>0</td>
<td>24-31, 48-63</td>
<td><em>Designated for custom use</em></td>
</tr>
</tbody>
</table></li>
</ul></li>
<li><p><code>mtval (0x343)</code>: Machine Trap Value, provides extra information about exceptions (their addresses and so on)</p></li>
</ol>
</section>
<section id="commonly-used-csr-instructions" class="level4">
<h4 class="anchored" data-anchor-id="commonly-used-csr-instructions">Commonly Used CSR instructions</h4>
<pre class="assembly"><code>;register version:
csrrw x5, mstatus, x10  ;x5 = mstatus (read), mstatus = x10 (write)
csrw mtvec, t0          ;mtvec = t0 (write only)
csrrs x5, mie, x10      ;x5 = mie (read), mie |= x10 (set)
csrrc x5, mie, x10      ;x5 = mie (read), mie &amp;= x10 (clear)

;imm version:
csrrwi x5, mstatus, 0x1 ;x5 = mstatus (read), mstatus = 0x1 (write imm)
csrrsi x5, mie, 0x1     ;x5 = mie (read), mie |= 0x1 (set imm)
csrrc x5, mie, 0x1      ;x5 = mie (read), mie &amp;= 0x1 (clear imm)</code></pre>
<p>Convenient pseudo-instructions:</p>
<pre class="assembly"><code>csrr rd, csr    ;csrrs rd, csr, x0
csrw csr, rs    ;csrrw x0, csr, rs
csrs csr, rs    ;csrrs x0, csr, rs
csrc csr, rs    ;csrrc x0, csr, rs
csrwi csr, imm  ;csrrwi x0, csr, imm
csrsi csr, imm  ;csrrsi x0, csr, imm
csrci csr, imm  ;csrrci x0, csr, imm</code></pre>
</section>
</section>
<section id="gprs-通用寄存器" class="level3">
<h3 class="anchored" data-anchor-id="gprs-通用寄存器">GPRs 通用寄存器</h3>
<section id="introduction-1" class="level4">
<h4 class="anchored" data-anchor-id="introduction-1">Introduction</h4>
<p>The 32 registers in RISC-V are called general-purpose registers (GPRs, or “integer registers”). They are used for various purposes, such as holding data, addresses, or temporary values during program execution. These registers are 32 bits wide in the RV32I ISA and are identified as x0 to x31.</p>
<p>Each register has a conventional name that indicates its intended usage, although these names are just conventions, and you can use them for other purposes if needed.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="gprs.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption>通用寄存器的 ABI 规范</figcaption>
</figure>
</div>
</section>
<section id="partial-explanations" class="level4">
<h4 class="anchored" data-anchor-id="partial-explanations">Partial Explanations</h4>
<ul>
<li><p><code>ra</code></p>
<p>Purpose: Stores the return address for function calls.</p>
<pre class="assembly"><code>jal ra, function_label  # Jump to function_label and store return address in ra
ret                     # Return to the address in ra</code></pre></li>
<li><p><code>sp</code></p>
<p>Purpose: Points to the top of the stack (used for dynamic memory allocation during function calls).</p>
<pre class="assembly"><code>addi sp, sp, -16      # Allocate 16 bytes on the stack
sw t0, 0(sp)          # Store t0 at the top of the stack
lw t0, 0(sp)          # Retrieve t0 from the stack
addi sp, sp, 16       # Deallocate 16 bytes</code></pre></li>
<li><p><code>gp</code></p>
<p>Purpose: Points to global and static data in memory.</p>
<pre class="assembly"><code>lw t0, 0(gp)         # Load a value from the global data section</code></pre></li>
<li><p><code>tp</code></p>
<p>Purpose: Points to thread-local storage (used in multi-threaded programs).</p>
<pre class="assembly"><code>lw t0, 0(tp)         # Load a thread-specific value</code></pre></li>
<li><p><code>t0-t6</code></p>
<p>Purpose: Temporary values, not preserved across function calls.</p></li>
</ul>
</section>
</section>
<section id="跳转指令" class="level3">
<h3 class="anchored" data-anchor-id="跳转指令">跳转指令</h3>
<section id="introduction-2" class="level4">
<h4 class="anchored" data-anchor-id="introduction-2">Introduction</h4>
<p>One category of instructions is jump operations (abbr. jmpop), which is just changing the value of PC (or some GPRs by the way)</p>
</section>
<section id="commonly-used-aluop-instructions" class="level4">
<h4 class="anchored" data-anchor-id="commonly-used-aluop-instructions">Commonly Used aluop instructions</h4>
<pre class="assembly"><code>; unconditional:
jal ra, 0x10        ;ra = PC + 4, PC += 0x10 (link and jump, should be laj)
jalr ra, 8(t0)      ;ra = PC + 4, PC += t0+8 (wrt a register)

; conditional:
beq t0, t1, 0x8     ;PC += 0x8 if t0 == t1 (branch if equal)
bne t0, t1, 0x8     ;PC += 0x8 if t0 != t1 (branch if not equal)
blt t0, t1, 0x8     ;PC += 0x8 if t0 &lt; t1 (signed less than)
bge t0, t1, 0x8     ;PC += 0x8 if t0 &gt;= t1 (signed greater or equal)
bltu t0, t1, 0x8    ;PC += 0x8 if t0 &lt; t1 (unsigned less than)
bgeu t0, t1, 0x8    ;PC += 0x8 if t0 &gt;= t1 (unsigned greater or equal)

auipc t0, 0x1000    ;t0 = PC + (0x1000 &lt;&lt; 12) (add upper imm and PC to a reg)</code></pre>
</section>
<section id="notes" class="level4">
<h4 class="anchored" data-anchor-id="notes">Notes</h4>
<pre class="assembly"><code>load:
    lbu a1, 0(t1)
    sb a1, 0(t2)
    addi t1, t1, 1
    addi t2, t2, 1
    bltu t2, t3, load</code></pre>
<p>If <code>lbu a1, 0(t1)</code> is at location 0x8000001a, then this line: <code>bltu t2, t3, load</code> does NOT mean</p>
<pre class="assembly"><code>PC += 0x8000001a if t2 &lt; t3</code></pre>
<p>but</p>
<pre class="assembly"><code>PC = 0x8000001a if t2 &lt; t3</code></pre>
<p>(done by the smart compiler!)</p>
</section>
</section>
<section id="machine-mode" class="level3">
<h3 class="anchored" data-anchor-id="machine-mode">Machine Mode</h3>
<section id="introduction-3" class="level4">
<h4 class="anchored" data-anchor-id="introduction-3">Introduction</h4>
<p>One category of instructions is machine operations (abbr. machineop), which is a set of <em>privileged</em> instructions in the RISC-V privileged architecture. These instructions are all related to the <a href="csr.md">CSRs</a>, so make sure you are familiar with those registers first.</p>
</section>
<section id="riscv-privilege-levels-from-high-to-low" class="level4">
<h4 class="anchored" data-anchor-id="riscv-privilege-levels-from-high-to-low">RISCV Privilege Levels from High to Low</h4>
<ul>
<li>Debug (D)</li>
<li>Machine (M): “must-have”</li>
<li>Supervisor (S)
<ul>
<li>Hypervisor-extended Supervisor (HS)</li>
<li>Virtual Supervisor (VS)</li>
<li>Virtual User (VU)</li>
</ul></li>
<li>User (U)</li>
</ul>
</section>
<section id="commonly-used-machineop-instructions" class="level4">
<h4 class="anchored" data-anchor-id="commonly-used-machineop-instructions">Commonly Used machineop instructions</h4>
<ul>
<li><p><code>mret</code>: Return from Machine-mode to Supervisor-mode (or User-mode). Steps:</p>
<ol type="1">
<li>Restore the privilege mode:
<ul>
<li>The processor sets the current privilege mode based on MPP from mstatus.</li>
<li>MPP is cleared to user mode (00) or supervisor mode (01) if applicable.</li>
</ul></li>
<li>Restore the interrupt enable status:
<ul>
<li>The MIE bit in mstatus is set to MPIE.</li>
<li>The MPIE bit is cleared (0).</li>
</ul></li>
<li>Restore the program counter (PC):
<ul>
<li>The PC is set to the value stored in mepc, resuming execution where it was interrupted.</li>
</ul></li>
</ol></li>
</ul>
</section>
</section>
<section id="内存操作" class="level3">
<h3 class="anchored" data-anchor-id="内存操作">内存操作</h3>
<section id="introduction-4" class="level4">
<h4 class="anchored" data-anchor-id="introduction-4">Introduction</h4>
<p>One category of instructions is memory operations (abbr. memop), which is just exchanging data between GPRs to memory locations.</p>
<p>So naturally, these signals are crucial for storing a data into memory:</p>
<ul>
<li><code>WE</code>: Write enable. Whenever a memop intruction is detected, the memory block needs to be enabled.</li>
<li><code>[31:0] data_mem</code>: the 32-bit data to be stored.</li>
<li><code>[31:0] mem_addr</code>: where to be stored.</li>
<li><code>[3:0] storebytes_size</code>: Store a byte (0001), half word (0011), or a word (1111)?</li>
</ul>
</section>
<section id="commonly-used-memop-instructions" class="level4">
<h4 class="anchored" data-anchor-id="commonly-used-memop-instructions">Commonly Used memop instructions</h4>
<pre class="assembly"><code>lui t0, 0x40000 ;t0 = 0x40000 &lt;&lt; 12b (load unsigned imm)
lb t0, 1(a0)    ;t0 = mem[a0 + 1] (load byte)
lh t0, 2(a0)    ;t0 = mem[a0 + 2] (load half word)
lw t0, 4(a0)    ;t0 = mem[a0 + 4] (load word)
lbu t0, 1(a0)   ;unsigned (zero extending)
lhu t0, 2(a0)   ;unsigned (zero extending)

sb t0, 1(a0)    ;mem[a0 + 1] = t0 (store byte)
sh t0, 2(a0)    ;mem[a0 + 2] = t0 (store half word)
sw t0, 4(a0)    ;mem[a0 + 4] = t0 (store word)</code></pre>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../c-riscv-asm/c-riscv-asm.html" class="pagination-link" aria-label="C 和 RISCV 汇编">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">C 和 RISCV 汇编</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../cc-os/cc-os.html" class="pagination-link" aria-label="OS 操作系统原理">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">OS 操作系统原理</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>