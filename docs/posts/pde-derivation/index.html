<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.41">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Marcobisky">
<meta name="dcterms.date" content="2025-04-05">
<meta name="description" content="First chapter of PDE series!">

<title>PDE: Wave and Heat Equations Made Obvious 推导波动方程与热传导方程 – Marcobisky</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-48ffa3e5b9d089919c6712c39e5b00f2.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-71390cc8b9bae10139428574d3aab2c6.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-7296923c0d2fcbb96815fa438c9ef20b.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-3b107ac41cb128c3aa015a9f6b976a40.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="PDE: Wave and Heat Equations Made Obvious 推导波动方程与热传导方程 – Marcobisky">
<meta property="og:description" content="First chapter of PDE series!">
<meta property="og:image" content="https://marcobisky.github.io/posts/pde-derivation/cover.gif">
<meta property="og:site_name" content="Marcobisky">
<meta property="og:locale" content="en_US">
<meta name="twitter:title" content="PDE: Wave and Heat Equations Made Obvious 推导波动方程与热传导方程 – Marcobisky">
<meta name="twitter:description" content="First chapter of PDE series!">
<meta name="twitter:image" content="https://marcobisky.github.io/posts/pde-derivation/cover.gif">
<meta name="twitter:creator" content="@Marcobisky77">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Marcobisky</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../cv"> 
<span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../tinyml/index.html"> 
<span class="menu-text">TinyML</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../blog.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#takeaways" id="toc-takeaways" class="nav-link active" data-scroll-target="#takeaways">Takeaways</a></li>
  <li><a href="#welcome" id="toc-welcome" class="nav-link" data-scroll-target="#welcome"><span class="header-section-number">1</span> Welcome!</a></li>
  <li><a href="#wave-equation" id="toc-wave-equation" class="nav-link" data-scroll-target="#wave-equation"><span class="header-section-number">2</span> Wave Equation</a>
  <ul class="collapse">
  <li><a href="#d-wave-equation" id="toc-d-wave-equation" class="nav-link" data-scroll-target="#d-wave-equation"><span class="header-section-number">2.1</span> 1D Wave Equation</a></li>
  <li><a href="#d-wave-equation-1" id="toc-d-wave-equation-1" class="nav-link" data-scroll-target="#d-wave-equation-1"><span class="header-section-number">2.2</span> 2D Wave Equation</a></li>
  </ul></li>
  <li><a href="#heat-equation" id="toc-heat-equation" class="nav-link" data-scroll-target="#heat-equation"><span class="header-section-number">3</span> Heat Equation</a>
  <ul class="collapse">
  <li><a href="#d-heat-equation" id="toc-d-heat-equation" class="nav-link" data-scroll-target="#d-heat-equation"><span class="header-section-number">3.1</span> 1D Heat Equation</a></li>
  <li><a href="#d-heat-equation-1" id="toc-d-heat-equation-1" class="nav-link" data-scroll-target="#d-heat-equation-1"><span class="header-section-number">3.2</span> 3D Heat Equation</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full column-page-left" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">PDE: Wave and Heat Equations Made Obvious 推导波动方程与热传导方程</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Differential-Equation</div>
    <div class="quarto-category">EN-blogs</div>
  </div>
  </div>

<div>
  <div class="description">
    First chapter of PDE series!
  </div>
</div>


<div class="quarto-title-meta column-page-left">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Marcobisky </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">April 5, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="takeaways" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="takeaways">Takeaways</h2>
<ol type="1">
<li><p>Conservation law seems underratedly important.</p></li>
<li><p>Oscillation and overshooting comes from second order time derivative. Smooth exponential decay comes from first order time derivative.</p></li>
<li><p><span class="math inline">\(a_{n+1} + a_{n-1} - 2a_n\)</span> is the second order spatial derivative, the mental picture of it is the difference between current value and the average of its two neighbors.</p></li>
<li><p>Forcing terms are usually comes with second order spacial derivative. This is because first order spacial derivative only represent force from one side, and second order spacial derivative is the net force of the neighboring particles acting on the particle we analyze.</p></li>
</ol>
</section>
<section id="welcome" class="level2 page-columns page-full" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="welcome"><span class="header-section-number">1</span> Welcome!</h2>
<p>This is the first chapter of my PDE series. You will learn how to derive two of the most important PDEs in physics: <strong>Wave equation and heat equation</strong>, with nearly no prerequisites. The goal of this article is to make these two equations <em>as obvious as possible</em><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> to you:</p>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>&nbsp;We <strong>avoid</strong> using the notation <span class="math inline">\(\Delta\)</span> for <span class="math inline">\(\nabla^2\)</span>. <span class="math inline">\(\Delta\)</span> in this article just mean “difference in” blablabla. We also use <span class="math inline">\(\xi_{t}\)</span> and <span class="math inline">\(\xi_{tt}\)</span> to represent <span class="math inline">\(\frac{\partial \xi}{\partial t}\)</span> and <span class="math inline">\(\frac{\partial^2 \xi}{\partial t^2}\)</span>.</p></div></div><ul>
<li><strong>Wave equation</strong>: <span class="math inline">\(\xi_{tt} = c^2 \nabla^2 \xi\)</span>.</li>
<li><strong>Heat equation</strong>: <span class="math inline">\(T_t = \alpha \nabla^2 T\)</span>.</li>
</ul>
<p>Let’s do it!</p>
</section>
<section id="wave-equation" class="level2 page-columns page-full" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="wave-equation"><span class="header-section-number">2</span> Wave Equation</h2>
<section id="d-wave-equation" class="level3 page-columns page-full" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="d-wave-equation"><span class="header-section-number">2.1</span> 1D Wave Equation</h3>
<p>There are two kinds of one-dimensional wave: longitudinal and transverse.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="longitudinal-transverse-wave.png" class="img-fluid figure-img"></p>
<figcaption>Longitudinal wave and transverse wave cartoon</figcaption>
</figure>
</div>
<p>They look totally different, but they share exactly the same properties and could be described by the same wave PDE! Let’s have a look at longitudinal wave first.</p>
<section id="longitudinal-wave" class="level4 page-columns page-full" data-number="2.1.1">
<h4 data-number="2.1.1" class="anchored" data-anchor-id="longitudinal-wave"><span class="header-section-number">2.1.1</span> Longitudinal Wave</h4>
<p>This kind of wave can be considered as little balls connected by springs:</p>
<div id="fig-longitudinal-equilibrium" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-longitudinal-equilibrium-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="longitudinal-equilibrium.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-longitudinal-equilibrium-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Balls at equilibrium position
</figcaption>
</figure>
</div>
<p>As shown in <a href="#fig-longitudinal-equilibrium" class="quarto-xref">Figure&nbsp;1</a>, each small ball is in a tranquil state called “equilibrium position” where all resultant force acting on it is zero. Now we want to describe the system when there are perturbations using PDEs. So there should be a variable that depends on time and space. What is that variable? Well, we should define it. Let’s make it the displacement value <span class="math inline">\(\xi(x,t)\)</span> of each ball from its equilibrium position.</p>
<div id="fig-longitudinal-zoomed-in" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-longitudinal-zoomed-in-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="longitudinal-zoomed-in.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-longitudinal-zoomed-in-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Zoom in at one of the balls
</figcaption>
</figure>
</div>
<p>Consider the scenario shown in <a href="#fig-longitudinal-zoomed-in" class="quarto-xref">Figure&nbsp;2</a>, we zoom in at the <span class="math inline">\(n\)</span>-th ball. In order to find the equation of motion for this ball, we need to define some parameters:</p>
<ul>
<li><span class="math inline">\(k\)</span>: Microscopic string constant.</li>
<li><span class="math inline">\(m\)</span>: Mass of each ball.</li>
</ul>
<p>The net force acting on the <span class="math inline">\(n\)</span>-th ball is the sum of the forces from the two adjacent balls: <span class="math display">\[
\begin{aligned}
F_n &amp;= F_L + F_R \\
&amp;= (-F_0 - k(\xi_n - \xi_{n-1})) + (F_0 + k(\xi_{n+1} - \xi_n)) \\
&amp;= k((\xi_{n+1} - \xi_n) - (\xi_n - \xi_{n-1})),
\end{aligned}
\]</span> where <span class="math inline">\(F_0\)</span> is the force from both left and right balls acting on the <span class="math inline">\(n\)</span>-th ball at equilibrium position (they balanced out at equilibrium position). According to Newton’s second law<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> <span class="math inline">\(F_n = m \ddot \xi_n\)</span>, we have: <span id="eq-longitude-discrete"><span class="math display">\[
k((\xi_{n+1} - \xi_n) - (\xi_n - \xi_{n-1})) = m \ddot \xi_n.
\tag{1}\]</span></span></p>
<div class="no-row-height column-margin column-container"><div id="fn2"><p><sup>2</sup>&nbsp;<span class="math inline">\(\ddot \xi_n\)</span> means <span class="math inline">\(\frac{\partial^2 \xi}{\partial t^2}\)</span> in the article.</p></div></div><p>Now <a href="#eq-longitude-discrete" class="quarto-xref">Equation&nbsp;1</a> should be it! But in reality, we do not know <span class="math inline">\(m\)</span> and <span class="math inline">\(k\)</span> since they are <em>microscopic parameters</em>. We now define some new parameters to connect the quantities that we can measure with the microscopic parameters:</p>
<ul>
<li><span class="math inline">\(N\)</span>: Total number of balls.</li>
<li><span class="math inline">\(\Delta l\)</span>: Microscopic distance between adjacent balls.</li>
<li><span class="math inline">\(L\)</span>: Total length, <span class="math inline">\(L = N \Delta l\)</span>.</li>
<li><span class="math inline">\(M\)</span>: Total mass of the system, <span class="math inline">\(M = Nm\)</span>.</li>
<li><span class="math inline">\(\rho\)</span>: Mass density, <span class="math inline">\(\rho = \frac{M}{L}\)</span>.</li>
<li><span class="math inline">\(K\)</span>: Total spring constant<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>, <span class="math inline">\(K = \frac{k}{N}\)</span>.</li>
</ul>
<div class="no-row-height column-margin column-container"><div id="fn3"><p><sup>3</sup>&nbsp;The spring constant of serial spring is smaller than that of individual spring by a factor of <span class="math inline">\(N\)</span>.</p></div></div><p>Now <a href="#eq-longitude-discrete" class="quarto-xref">Equation&nbsp;1</a> becomes: <span class="math display">\[
\begin{align*}
&amp;k \frac{(\xi_{n+1} - \xi_n) - (\xi_n - \xi_{n-1})}{(\Delta l)^2} = \frac{\rho \ddot \xi_n}{\Delta l} \\
\implies\quad &amp;k \xi_{xx} = \frac{\rho \ddot \xi_n}{\Delta l} \\
\implies\quad &amp;\ddot \xi_n = \frac{k \Delta l}{\rho} \xi_{xx} = \frac{NK \frac{L}{N}}{\frac{M}{L}} \xi_{xx} \\
\implies\quad &amp;\ddot \xi_n = \frac{KL^2}{M} \xi_{xx}
\end{align*}
\]</span></p>
<p><span class="math inline">\(n\)</span> is arbitrary, so we got: <span class="math display">\[
\boxed{
\ddot \xi = \frac{KL^2}{M} \xi_{xx}.
}
\]</span></p>
</section>
<section id="sec-transverse-wave" class="level4 page-columns page-full" data-number="2.1.2">
<h4 data-number="2.1.2" class="anchored" data-anchor-id="sec-transverse-wave"><span class="header-section-number">2.1.2</span> Transverse wave</h4>
<p>To derive the wave equation for transverse wave, we need to make some basic assumptions:</p>
<ol type="1">
<li><p>Every particle could only move in a fixed line perpendicular to the direction of wave propagation, which means the horizontal resultant force is zero for each particle.</p></li>
<li><p>The vibration amplitude is extremely small.</p></li>
<li><p>Following above, the tension (density) is constant throughout the string.</p></li>
</ol>

<div class="no-row-height column-margin column-container"><div class="">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="transverse-only-verticle.png" class="img-fluid figure-img"></p>
<figcaption>Only verticle movement of each particle</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="transverse-small-amplitude.png" class="img-fluid figure-img"></p>
<figcaption>Vibration amplitude of each particle is small</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="transverse-tension-constant.png" class="img-fluid figure-img"></p>
<figcaption>Tension is asssumed to be invariant</figcaption>
</figure>
</div>
</div></div><p>Now we define some parameters of the string:</p>
<ul>
<li><span class="math inline">\(T\)</span>: Tension of the string.</li>
<li><span class="math inline">\(\lambda\)</span>: Line density of the string (mass per unit length).</li>
</ul>
<p>We focus on an element of the string shown in <a href="#fig-transverse-line-segment" class="quarto-xref">Figure&nbsp;3</a>.</p>
<div id="fig-transverse-line-segment" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-transverse-line-segment-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="transverse-line-segment.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-transverse-line-segment-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Line segment of the string
</figcaption>
</figure>
</div>
<p>Suppose the mass of that element is <span class="math inline">\(\Delta m\)</span>, the displacement is <span class="math inline">\(\xi\)</span>. The resultant force <span class="math display">\[
\begin{align*}
&amp; \Sigma F = \Delta m \cdot \ddot{\xi} \\
\implies\quad &amp; T \sin \theta_2 - T \sin \theta_1 = \lambda \frac{\Delta x}{\cos \theta_1} \cdot \ddot{\xi}
\end{align*}
\]</span></p>
<p>Since <span class="math inline">\(\theta_1, \theta_2 \to 0, \cos \theta_1 \approx 1, \sin \theta \approx \tan \theta\)</span>, we have: <span class="math display">\[
\begin{align*}
&amp;T(\tan \theta_2 - \tan \theta_1) = \lambda \Delta x \cdot \ddot{\xi} \\
\implies\quad &amp;T \left( \left. \frac{\partial \xi}{\partial x} \right|_{x+\Delta x} - \left. \frac{\partial \xi}{\partial x} \right|_{x}  \right) = \lambda \Delta x \cdot \ddot{\xi} \\
\implies\quad &amp;T \frac{\partial^2 \xi}{\partial x^2} \Delta x = \lambda \Delta x \cdot \ddot{\xi} \\
\implies\quad &amp;\frac{T}{\lambda} \xi_{xx} = \ddot{\xi}.
\end{align*}
\]</span></p>
<p>Done! This is the wave equation for transverse wave. We can also see the famous result that the wave speed is the square root of tension divide by density: <span class="math display">\[
v = \sqrt{\frac{T}{\lambda}}.
\]</span></p>
<!-- ----------------------------------------- -->
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Spatial Second order derivative
</div>
</div>
<div class="callout-body-container callout-body">
<p>In the derivation of the two kinds of waves, the crucial part! is the realization that these two expressions: <span id="eq-average"><span class="math display">\[
(\xi_{n+1} - \xi_n) - (\xi_n - \xi_{n-1})
\tag{2}\]</span></span> and <span class="math display">\[
\left. \frac{\partial \xi}{\partial x} \right|_{x+\Delta x} - \left. \frac{\partial \xi}{\partial x} \right|_{x}
\]</span> are essentially the <strong>second order spatial derivative</strong> <span class="math inline">\(\xi_{xx}\)</span>. This is obvious if you recall the definition of second derivative: just the derivative of derivative. Or in discrete version, <strong>the difference of difference</strong>. In particular, <a href="#eq-average" class="quarto-xref">Equation&nbsp;2</a> can be also interpreted as the comparison between current value and the average of its two neighbors<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>: <span id="eq-average-2"><span class="math display">\[
(\xi_{n+1} - \xi_n) - (\xi_n - \xi_{n-1}) \propto \frac{T_{n-1} + T_{n+1}}{2} - T_n.
\tag{3}\]</span></span></p>
<p>We will encounter this in the derivation of heat equation as well, so keep this in mind!</p>
</div>
</div>
<!-- ----------------------------------------- -->
<div class="no-row-height column-margin column-container"><div id="fn4"><p><sup>4</sup>&nbsp;This incredible idea is inspired by <a href="https://www.youtube.com/watch?v=ly4S0oi3Yz8">this video</a> by 3Blue1Brown.</p></div></div></section>
</section>
<section id="d-wave-equation-1" class="level3 page-columns page-full" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="d-wave-equation-1"><span class="header-section-number">2.2</span> 2D Wave Equation</h3>
<p>You may think the 2D analog is something like <a href="#fig-d2-longitudinal-wave" class="quarto-xref">Figure&nbsp;4</a>. However, this kind of wave is <strong>vector-valued</strong> just like electromagnetic wave, where the “amplitude” <span class="math inline">\(\mathbf{\xi}: \mathbb{R}^n \times \mathbb{R} \to \mathbb{R}^n\)</span> is a time-dependent vector field. We will focus on <strong>scalar-valued</strong> waves in this article, leaving vector-valued waves in the future discussion<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>. In fact, the transverse wave (shown in <a href="#fig-d2-transverse-wave" class="quarto-xref">Figure&nbsp;5</a>) is quite accurate for 2D scalar-valued waves.</p>
<div class="no-row-height column-margin column-container"><div id="fn5"><p><sup>5</sup>&nbsp;For those of the curious reader, the wave equation <span class="math inline">\(\mathbf{\xi}_{tt} = c^2 \nabla^2 \mathbf{\xi}\)</span> is also true <em>component-wise</em> for vector-valued waves, i.e., <span class="math inline">\((\mathbf{\xi}_i)_{tt} = c^2 \nabla^2 \mathbf{\xi}_i\)</span>.</p></div></div><div>

</div>
<div class="quarto-layout-panel" data-layout-nrow="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-d2-longitudinal-wave" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-d2-longitudinal-wave-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="d2-longitudinal-wave.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-d2-longitudinal-wave-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Vector-valued 2D longitudinal wave
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-d2-transverse-wave" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-d2-transverse-wave-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="d2-transverse-wave.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-d2-transverse-wave-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Scalar-valued 2D transverse wave
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>You can imagine <a href="#fig-d2-transverse-wave" class="quarto-xref">Figure&nbsp;5</a> as a curved rubber band with similar assumptions in <a href="#sec-transverse-wave" class="quarto-xref">Section&nbsp;2.1.2</a>. Suppose:</p>
<ul>
<li><span class="math inline">\(T\)</span>: Tension <strong>per unit length</strong><a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a>.</li>
<li><span class="math inline">\(\sigma\)</span>: Surface mass density of the rubber band (mass per unit area).</li>
</ul>
<div class="no-row-height column-margin column-container"><div id="fn6"><p><sup>6</sup>&nbsp;Note that it doesn’t make sense to say “tension at a point” but “tension at both sides of a line of a given length” (unit: N/m).</p></div></div><p>Along <span class="math inline">\(z\)</span> axies, <span class="math display">\[
\begin{align*}
&amp;\Sigma F = \Delta m \cdot \ddot{\xi} \\
\implies\quad &amp;(T \Delta y) \frac{\partial^2 \xi}{\partial x^2} \Delta x + (T \Delta x) \frac{\partial^2 \xi}{\partial y^2} \Delta y = \sigma (\Delta x \Delta y) \frac{\partial^2 \xi}{\partial t^2} \\
\implies\quad &amp;\frac{T}{\sigma} (\xi_{xx} + \xi_{yy}) = \ddot{\xi}.
\end{align*}
\]</span></p>
<p>This can also be generalized to wave equation in <span class="math inline">\(n\)</span> dimension: <span class="math display">\[
\boxed{
\ddot{\xi} = \frac{T}{\sigma} \nabla^2 \xi. }
\]</span></p>
</section>
</section>
<section id="heat-equation" class="level2 page-columns page-full" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="heat-equation"><span class="header-section-number">3</span> Heat Equation</h2>
<section id="d-heat-equation" class="level3 page-columns page-full" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="d-heat-equation"><span class="header-section-number">3.1</span> 1D Heat Equation</h3>
<section id="modelling" class="level4 page-columns page-full" data-number="3.1.1">
<h4 data-number="3.1.1" class="anchored" data-anchor-id="modelling"><span class="header-section-number">3.1.1</span> Modelling</h4>
<p>The following physical model of heat conduction on a rod is based on the following assumptions and facts:</p>
<ol type="1">
<li><p>No thermal source on the thin rod.</p></li>
<li><p><strong>(Prop Relation 1)</strong> <span class="math inline">\(T\)</span> (in Kelvin) is <em>defined</em> to be proportional<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a> to thermal energy <span class="math inline">\(Q\)</span> (in <span class="math inline">\(\text{J}\)</span>), i.e., <span class="math display">\[
T : \propto Q.
\]</span></p>
<p>This is reflected in the following well-known fact: <span class="math display">\[
\Delta Q = cm \Delta T,
\]</span> where <span class="math inline">\(c\)</span> is the specific heat capacity of the rod, <span class="math inline">\(m\)</span> is the mass we analyze on.</p></li>
<li><p><strong>(Prop Relation 2)</strong> Conduction of heat energy is <strong><em>proportional</em></strong> to temperature difference<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a>: <span class="math display">\[
\boxed{
q = -k \nabla T,}
\]</span> where <span class="math inline">\(q\)</span> is called <strong>heat flux density</strong><a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a>, the amount of thermal energy passing through a point (1D case) or a unit area (3D case)</p></li>
<li><p>Thermal energy in conserved!</p></li>
</ol>
<!-- ----------------------------------------- -->
<div class="no-row-height column-margin column-container"><div id="fn7"><p><sup>7</sup>&nbsp;Loosely speaking, this is the <em>definition</em> of temperature. If there is no temperature (<span class="math inline">\(T = 0\text{ K}\)</span>), then there is no particle motion, <span class="math inline">\(Q = 0\)</span>.</p></div><div id="fn8"><p><sup>8</sup>&nbsp;This famous equation is called <strong>Fourier’s law for heat conduction</strong>.</p></div><div id="fn9"><p><sup>9</sup>&nbsp;Since in 1D case, <span class="math inline">\(q\)</span> is just the amount of thermal energy pssing through a <em>point</em>. Thus in 1D, we often drop the word “density” by just saying “heat flux”.</p></div></div><div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Importance of proportion relations
</div>
</div>
<div class="callout-body-container callout-body">
<p>You may have noticed there are two proportional relations: <span class="math display">\[
    T : \propto Q.
\]</span> This allows us to use temperature to reflect energy! Temperature is more tangible than energy. <span class="math display">\[
    q = -k \nabla T.
\]</span> This connects time derivative and space derivative. So Heat equation is actully easier to derive since this Fourier’s law directly gives us nearly the final result. I say nearly because the only thing left is the <strong>conservation of energy</strong>!</p>
</div>
</div>
<!-- ----------------------------------------- -->
</section>
<section id="derivation" class="level4 page-columns page-full" data-number="3.1.2">
<h4 data-number="3.1.2" class="anchored" data-anchor-id="derivation"><span class="header-section-number">3.1.2</span> Derivation</h4>
<p>The notations used are defined below:</p>
<ul>
<li><span class="math inline">\(\lambda\)</span>: Line density of the rod (mass per unit length).</li>
<li><span class="math inline">\(x, x + \Delta x\)</span>: The coordinates of the start and end points of the rod segment we analyze (Right is the positive direction).</li>
<li><span class="math inline">\(T: \mathbb{R} \times \mathbb{R} \to \mathbb{R}\)</span>: Temperature field (time dependent) on the rod.</li>
</ul>
<p>The quantity we care is obviously how the temperature changes over time and space. We chooce a tiny segment of the rod of length <span class="math inline">\(\Delta x\)</span> and build equation on it. The temperature on that extremely small segment can be viewed as a constant.</p>
<div id="fig-rod-segment" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-rod-segment-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="rod-segment.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-rod-segment-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Energy conservation on a small element of the rod
</figcaption>
</figure>
</div>
<p>As shown in <a href="#fig-rod-segment" class="quarto-xref">Figure&nbsp;6</a>, suppose the left side of the rod is hotter than its right side<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a>. We know that the thermal energy increased in <span class="math inline">\(\mathrm{d}t\)</span> should equal to thermal energy entering the segment on the left minus thermal energy leaving the segment on the right: <span id="eq-energy-conservation"><span class="math display">\[
\frac{\mathrm{d} Q}{\mathrm{d} t} = q_{\text{in, left}} - q_{\text{out, right}}.
\tag{4}\]</span></span></p>
<div class="no-row-height column-margin column-container"><div id="fn10"><p><sup>10</sup>&nbsp;This is an assumption without loss of generality in terms of writing out the heat equation. The signs can be a lot tricker to determine if you don’t have a certain physical picture.</p></div></div><p>Now we expect <span class="math inline">\(q_{\text{in, left}}\)</span> and <span class="math inline">\(q_{\text{out, right}}\)</span> to be both positive. The gradient of temperature <span class="math inline">\(\frac{\partial T}{\partial x}\)</span> on position <span class="math inline">\(x\)</span> and <span class="math inline">\(x + \Delta x\)</span> are both negative (since temperature decreases along the positive direction), therefore, <span class="math display">\[
\begin{aligned}
q_{\text{in, left}} &amp;= \left. -k \frac{\partial T}{\partial x} \right|_{x} &gt; 0 \\
q_{\text{out, right}} &amp;= \left. -k \frac{\partial T}{\partial x} \right|_{x + \Delta x} &gt; 0.
\end{aligned}
\]</span></p>
<p>Therefore, <a href="#eq-energy-conservation" class="quarto-xref">Equation&nbsp;4</a> becomes: <span class="math display">\[
\begin{align*}
&amp; \frac{\mathrm{d} Q}{\mathrm{d} t} = k (T_x|_{x+\Delta x} - T_x|_{x}) \\
\implies\quad &amp; c (\lambda \Delta x) \frac{\partial T}{\partial t} = k T_{xx} \Delta x \\
\implies\quad &amp; T_t = \frac{k}{c \lambda} T_{xx}.
\end{align*}
\]</span></p>
<p>Just this simple, we derived the heat equation! <span class="math display">\[
\boxed{
T_t = \frac{k}{c \lambda} T_{xx}.}
\]</span></p>
<!-- ----------------------------------------- -->
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Why do wave equation and heat equation so similar and different?
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>Why do they both have <span class="math inline">\(\xi_{xx}\)</span> term?</p>
<p>The “forcing” on a small element is proportional to the change of changes. This is very common in nature.</p>
<ul>
<li>In wave case, the force on each particle not depend on the change of displacement of adjacent particles, but the change of the change (because first order determines <em>force</em> on either side, second order determines the <em>net force</em> on the particle we analyze)!</li>
<li>In heat case, the heat increase in a small segment does not depend on first order derivative of temperature field, that’s just one side. There’s yet another side that may compensate for this change in temperature. So it’s the difference of difference that matters.</li>
</ul></li>
<li><p>Why temperature only cares first order time derivative?</p>
<p>There’s a fundamental difference between wave equation and heat equation: Heat will never <em>overshoot</em> but wave will. In other words, a spring will overshoot its equilibrium with maximal speed, resulting a movement of back and forth. But heat will evolve as smooth and efficient as possible, never oscillating.</p></li>
</ol>
<div>

</div>
<div class="quarto-layout-panel" data-layout-nrow="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Heat.gif" class="img-fluid figure-img"></p>
<figcaption>Heat diffusion</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Wave.gif" class="img-fluid figure-img"></p>
<figcaption>Wave propagation<a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a></figcaption>
</figure>
</div>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>A second order derivative in time means overshooting.</p>
</blockquote>
<p>Second order time derivative appears in wave equation is because Newton’s second law involves acceleration. Whereas in heat equation the first order time derivative actually comes from conservation laws. There is a wide class of PDEs (called <strong>continuity equation</strong>) that can be derived from conservation law. We will discuss this later.</p>
<p>Just to give a intuitive understanding of the difference behavior of wave and heat, recall that in <a href="#eq-average-2" class="quarto-xref">Equation&nbsp;3</a> we introduced a new way of looking at second order spatial derivative (Difference to the average of its neighbors). As shown in <a href="#fig-difference-between-d-a-v" class="quarto-xref">Figure&nbsp;7</a>, the second order spatial derivative is proportional to the blue <span class="math inline">\(d\)</span>.</p>
<div id="fig-difference-between-d-a-v" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-difference-between-d-a-v-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="difference-between-d-a-v.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-difference-between-d-a-v-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Difference between <span class="math inline">\(d \propto a\)</span> and <span class="math inline">\(d\ propto v\)</span>
</figcaption>
</figure>
</div>
<p>The only difference in wave and heat equation is that if <span class="math inline">\(d\)</span> is proportional to the acceleration <span class="math inline">\(a\)</span> (of the middle particle), or its velocity <span class="math inline">\(v\)</span>, i.e., <span id="eq-heat-abstraction"><span class="math display">\[
\dot{\xi} = \xi
\tag{5}\]</span></span> or <span id="eq-wave-abstraction"><span class="math display">\[
\ddot{\xi} = \xi.
\tag{6}\]</span></span></p>
<p>The solution to <a href="#eq-heat-abstraction" class="quarto-xref">Equation&nbsp;5</a> is the famous exponential decay, whereas the solution to <a href="#eq-wave-abstraction" class="quarto-xref">Equation&nbsp;6</a> is obviously the ocsillation!</p>
</div>
</div>
<!-- ----------------------------------------- -->
<div class="no-row-height column-margin column-container"><div id="fn11"><p><sup>11</sup>&nbsp;Made with <a href="https://visualpde.com/explore.html">this website</a> where you can explore different PDEs visually!</p></div></div></section>
</section>
<section id="d-heat-equation-1" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="d-heat-equation-1"><span class="header-section-number">3.2</span> 3D Heat Equation</h3>
<p>Now substitude the rod with a 3D material like metal. Suppose</p>
<ul>
<li><span class="math inline">\(\rho\)</span>: Volume density of the rod (mass per unit volume).</li>
<li><span class="math inline">\(\Delta V\)</span>: Volume of the small segment we analyze, <span class="math inline">\(\Delta V = \Delta x \Delta y \Delta z\)</span>.</li>
<li><span class="math inline">\(T: \mathbb{R}^3 \times \mathbb{R} \to \mathbb{R}\)</span>: Temperature field (time dependent) on the rod.</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="metal-segment.png" class="img-fluid figure-img"></p>
<figcaption>Isolate a small sube inside the metal</figcaption>
</figure>
</div>
<p>From conservation of thermal energy, the increase of <span class="math inline">\(Q\)</span> is unit time equal to net energy entering the volume from <span class="math inline">\(x, y, z\)</span> directions. We already know that in one dimension, say <span class="math inline">\(x\)</span>, the net increase in thermal energy is proportional to the second spatial derivative times the nudge length: <span class="math display">\[
q = k T_{xx} \overbrace{\Delta x}^{\text{nudge}}.
\]</span></p>
<p>However, <span class="math inline">\(q\)</span> is three-dimension is the heat flux <em>density</em>, so we also need to multiply the cross section area: <span class="math display">\[
\frac{\mathrm{d} Q}{\mathrm{d} t} = q \cdot \Delta \text{Area} = \overbrace{k T_{xx} \Delta x}^{\text{density}} \cdot \overbrace{(\Delta y \Delta z)}^{\text{area size}}.
\]</span></p>
<p>Sum up all heat contributions from three directions: <span class="math display">\[
\begin{align*}
&amp; \Sigma \frac{\mathrm{d} Q}{\mathrm{d} t} = q_x (\Delta y \Delta z) + q_y (\Delta z \Delta x) + q_z (\Delta x \Delta y) \\
\implies\quad &amp; c (\rho \Delta V) \frac{\partial T}{\partial t} = (k T_{xx} \Delta x)(\Delta y \Delta z) + (k T_{yy} \Delta y)(\Delta z \Delta x) + (k T_{zz} \Delta z)(\Delta x \Delta y) \\
\implies\quad &amp; T_t = \frac{k}{c \rho} (T_{xx} + T_{yy} + T_{zz}),
\end{align*}
\]</span> i.e., <span class="math display">\[
\boxed{
T_t = \frac{k}{c \rho} \nabla^2 T.}
\]</span></p>
<p>This could be natually generalized to <span class="math inline">\(n\)</span> dimensions.</p>
</section>
</section>
<section id="references" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="references">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-lamoureux_2006_the" class="csl-entry" role="listitem">
Lamoureux, Michael. 2006. <span>“The Mathematics of PDEs and the Wave Equation.”</span> <a href="https://mathtube.org/sites/default/files/lecture-notes/Lamoureux_Michael.pdf">https://mathtube.org/sites/default/files/lecture-notes/Lamoureux_Michael.pdf</a>.
</div>
</div>


</section>


</main> <!-- /main -->
<!-- Cloudflare Web Analytics --><script defer="" src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon="{&quot;token&quot;: &quot;d0b3c27b7e5c43938065722a5136416f&quot;}"></script><!-- End Cloudflare Web Analytics -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/marcobisky\.github\.io");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="Marcobisky.github.io" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© Copyright 2025 Marcobisky.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>