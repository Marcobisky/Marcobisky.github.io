<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.41">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Marcobisky">
<meta name="dcterms.date" content="2024-08-31">
<meta name="description" content="Wanna compile verilog on MacOS but without programing an FPGA? Check this out!">

<title>RTL Analysis on MacOS under 300MB – Marcobisky</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-48ffa3e5b9d089919c6712c39e5b00f2.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-7296923c0d2fcbb96815fa438c9ef20b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="RTL Analysis on MacOS under 300MB – Marcobisky">
<meta property="og:description" content="Wanna compile verilog on MacOS but without programing an FPGA? Check this out!">
<meta property="og:image" content="https://marcobisky.github.io/posts/digital-analysis-mac/cover.png">
<meta property="og:site_name" content="Marcobisky">
<meta property="og:locale" content="en_US">
<meta property="og:image:height" content="549">
<meta property="og:image:width" content="1569">
<meta name="twitter:title" content="RTL Analysis on MacOS under 300MB – Marcobisky">
<meta name="twitter:description" content="Wanna compile verilog on MacOS but without programing an FPGA? Check this out!">
<meta name="twitter:image" content="https://marcobisky.github.io/posts/digital-analysis-mac/cover.png">
<meta name="twitter:creator" content="@Marcobisky77">
<meta name="twitter:image-height" content="549">
<meta name="twitter:image-width" content="1569">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Marcobisky</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../cv"> 
<span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../tinyml/index.html"> 
<span class="menu-text">TinyML</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../blog.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#intro-and-overview" id="toc-intro-and-overview" class="nav-link active" data-scroll-target="#intro-and-overview"><span class="header-section-number">1</span> Intro and Overview</a>
  <ul class="collapse">
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">1.1</span> References</a></li>
  <li><a href="#tools-related" id="toc-tools-related" class="nav-link" data-scroll-target="#tools-related"><span class="header-section-number">1.2</span> Tools related</a></li>
  </ul></li>
  <li><a href="#first-project-in-verilog" id="toc-first-project-in-verilog" class="nav-link" data-scroll-target="#first-project-in-verilog"><span class="header-section-number">2</span> First Project in Verilog</a>
  <ul class="collapse">
  <li><a href="#install-icarus-verilog-compiler" id="toc-install-icarus-verilog-compiler" class="nav-link" data-scroll-target="#install-icarus-verilog-compiler"><span class="header-section-number">2.1</span> Install Icarus Verilog Compiler</a></li>
  <li><a href="#compilation-and-simulation" id="toc-compilation-and-simulation" class="nav-link" data-scroll-target="#compilation-and-simulation"><span class="header-section-number">2.2</span> Compilation and Simulation</a></li>
  <li><a href="#synthesis-and-visualization" id="toc-synthesis-and-visualization" class="nav-link" data-scroll-target="#synthesis-and-visualization"><span class="header-section-number">2.3</span> Synthesis and Visualization</a></li>
  <li><a href="#makefile-work-flow" id="toc-makefile-work-flow" class="nav-link" data-scroll-target="#makefile-work-flow"><span class="header-section-number">2.4</span> Makefile Work Flow</a></li>
  </ul></li>
  <li><a href="#first-project-in-vhdl" id="toc-first-project-in-vhdl" class="nav-link" data-scroll-target="#first-project-in-vhdl"><span class="header-section-number">3</span> First Project in VHDL</a>
  <ul class="collapse">
  <li><a href="#install-ghdl-compiler" id="toc-install-ghdl-compiler" class="nav-link" data-scroll-target="#install-ghdl-compiler"><span class="header-section-number">3.1</span> Install GHDL Compiler</a></li>
  <li><a href="#compilation-linking-and-simulation" id="toc-compilation-linking-and-simulation" class="nav-link" data-scroll-target="#compilation-linking-and-simulation"><span class="header-section-number">3.2</span> Compilation, Linking and Simulation</a></li>
  <li><a href="#no-synthesis-and-visualization-plan" id="toc-no-synthesis-and-visualization-plan" class="nav-link" data-scroll-target="#no-synthesis-and-visualization-plan"><span class="header-section-number">3.3</span> No Synthesis and Visualization Plan</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-page-left" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">RTL Analysis on MacOS under 300MB</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Awesome-Mac</div>
  </div>
  </div>

<div>
  <div class="description">
    Wanna compile verilog on MacOS but without programing an FPGA? Check this out!
  </div>
</div>


<div class="quarto-title-meta column-page-left">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Marcobisky </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">August 31, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="intro-and-overview" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="intro-and-overview"><span class="header-section-number">1</span> Intro and Overview</h2>
<section id="references" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="references"><span class="header-section-number">1.1</span> References</h3>
<p><strong>CLAIM</strong>: This article synthesizes conclusions and methods from multiple websites and is not pure original. 本文综合了多个网站的结论和方法，并非原创。</p>
<p>You may find these websites useful:</p>
<ul>
<li><a href="https://nishtahir.com/a-mostly-free-fpga-development-workflow-for-macos/">Workflow for FPGA development</a></li>
<li><a href="https://hackernoon.com/getting-started-using-open-source-fpga-tools">Some open-source tools</a></li>
<li><a href="https://www.hackster.io/whitney-knitter/fpga-development-on-m2-mac-tinyfpga-with-icestudio-39c300">IceStudio for M2 Mac</a></li>
<li><a href="https://github.com/YosysHQ/fpga-toolchain?tab=readme-ov-file">FPGA Toolchain</a></li>
<li><a href="https://www.reddit.com/r/VHDL/comments/12707lp/ghdl_on_mac_m1/">VHDL compile chain on MacOS</a></li>
</ul>
</section>
<section id="tools-related" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="tools-related"><span class="header-section-number">1.2</span> Tools related</h3>
<ul>
<li><p>You need these:</p>
<ul>
<li><a href="https://saiankit.medium.com/how-to-simulate-verilog-models-on-macos-5a6f821b2c4f">gtkwave</a>: main RTL wave creator</li>
<li><a href="https://github.com/steveicarus/iverilog">Icarus Verilog</a>, <a href="https://steveicarus.github.io/iverilog/usage/getting_started.html">and this manual</a></li>
<li><a href="https://github.com/yosyshq/yosys">YoSYS</a>: <code>.v</code> to <code>.json</code></li>
<li><a href="https://github.com/ghdl/ghdl?tab=readme-ov-file">GHDL</a>: compile, link and simulation tool for VHDL</li>
<li><a href="https://github.com/nturley/netlistsvg?tab=readme-ov-file">netlistsvg</a>: <code>.json</code> to <code>.svg</code></li>
</ul></li>
<li><p>Not nessasarily required:</p>
<ul>
<li><a href="https://sigrok.org/doc/pulseview/unstable/manual.html#_mac_os_x">Pulseview</a>: Logic Analyzer (Not required though)</li>
<li><a href="https://github.com/hneemann/Digital/releases">Digital</a>: Visual simulation</li>
</ul></li>
<li><p>Useful vscode plugins:</p>
<ul>
<li><a href="https://github.com/mshr-h/vscode-verilog-hdl-support">Verilog Support</a>: vscode verilog language highlighter</li>
<li><a href="https://marketplace.visualstudio.com/items?itemName=wavetrace.wavetrace&amp;ref=nishtahir.com">Wavetrace</a>: A nice vscode plugin to replace gtkwave</li>
</ul></li>
</ul>
</section>
</section>
<section id="first-project-in-verilog" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="first-project-in-verilog"><span class="header-section-number">2</span> First Project in Verilog</h2>
<section id="install-icarus-verilog-compiler" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="install-icarus-verilog-compiler"><span class="header-section-number">2.1</span> Install Icarus Verilog Compiler</h3>
<pre><code>brew install icarus-verilog</code></pre>
</section>
<section id="compilation-and-simulation" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="compilation-and-simulation"><span class="header-section-number">2.2</span> Compilation and Simulation</h3>
<!-- 新建文件夹`Verilog`，在其中新建两个测试文件：`GatedDLatch.v` and `GatedDLatch_tb.v`，前者为电路结构描述文件，后者为testbench文件，分别写入以下内容： -->
<p>Create new folder called <code>Verilog</code>, then create two test files named <code>GatedDLatch.v</code> and <code>GatedDLatch_tb.v</code>. The former is the description file of the circuit, the latter is for testbench. And write the following contents respectively:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode verilog code-with-copy"><code class="sourceCode verilog"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">// in GatedDLatch.v</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="kw">module</span> GatedDLatch <span class="op">(</span>Data<span class="op">,</span> WE<span class="op">,</span> Out<span class="op">,</span> OutBar<span class="op">);</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">input</span> Data<span class="op">;</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">input</span> WE<span class="op">;</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">output</span> Out<span class="op">;</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">output</span> OutBar<span class="op">;</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">// component name(output, input1, input2)</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">wire</span> S<span class="op">;</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">wire</span> R<span class="op">;</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="dt">wire</span> Dbar<span class="op">;</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="dt">nand</span> g1<span class="op">(</span>S<span class="op">,</span> Data<span class="op">,</span> WE<span class="op">);</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="dt">not</span> g2<span class="op">(</span>Dbar<span class="op">,</span> Data<span class="op">);</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="dt">nand</span> g3<span class="op">(</span>R<span class="op">,</span> WE<span class="op">,</span> Dbar<span class="op">);</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="dt">nand</span> g4<span class="op">(</span>Out<span class="op">,</span> S<span class="op">,</span> OutBar<span class="op">);</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    <span class="dt">nand</span> g5<span class="op">(</span>OutBar<span class="op">,</span> R<span class="op">,</span> Out<span class="op">);</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="kw">endmodule</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>and</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode verilog code-with-copy"><code class="sourceCode verilog"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">// in GatedDLatch_tb.v</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="ot">`timescale 1ns / 1ns </span><span class="co">// simulation time, time precision = 1ns</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">//Import the main code into the testbench</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="ot">`include </span><span class="fl">"GatedDLatch.v"</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="kw">module</span> GatedDLatch_tb<span class="op">;</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">//Inputs as registers</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="dt">reg</span> Data<span class="op">;</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="dt">reg</span> WE<span class="op">;</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co">//Outputs as wires</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="dt">wire</span> Out<span class="op">;</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="dt">wire</span> OutBar<span class="op">;</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co">//Initialisation</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>GatedDLatch uut<span class="op">(</span>Data<span class="op">,</span> WE<span class="op">,</span> Out<span class="op">,</span> OutBar<span class="op">);</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="kw">initial</span> <span class="kw">begin</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">//Name of the graph file that gets generated after we run</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="dt">$dumpfile</span><span class="op">(</span><span class="st">"GatedDLatch_tb.vcd"</span><span class="op">);</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    <span class="dt">$dumpvars</span><span class="op">(</span><span class="dv">0</span><span class="op">,</span>GatedDLatch_tb<span class="op">);</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    Data <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    WE <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    <span class="bn">#10</span><span class="op">;</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    Data <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    <span class="bn">#4</span><span class="op">;</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>    WE <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>    <span class="bn">#2</span><span class="op">;</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    WE <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>    <span class="bn">#4</span><span class="op">;</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>    Data <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>    <span class="bn">#4</span><span class="op">;</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>    WE <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>    <span class="bn">#2</span><span class="op">;</span></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>    WE <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>    <span class="bn">#4</span><span class="op">;</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>    <span class="dt">$display</span><span class="op">(</span><span class="st">"Test complete"</span><span class="op">);</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a><span class="kw">endmodule</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<!-- 终端运行： -->
<p>Run this in the terminal:</p>
<pre><code>iverilog -o GatedDLatch_tb.vvp GatedDLatch_tb.v</code></pre>
<!-- 将产生的二进制临时文件 `GatedDLatch_tb.vvp` 用 `vvp` 命令转换为 `GatedDLatch_tb.vcd`  waveform file: -->
<p>Use <code>vvp</code> command to convert the binary temperary file <code>GatedDLatch_tb.vvp</code> to <code>GatedDLatch_tb.vcd</code> waveform file:</p>
<pre><code>vvp GatedDLatch_tb.vvp</code></pre>
<!-- 安装 [Wavetrace](https://marketplace.visualstudio.com/items?itemName=wavetrace.wavetrace&ref=nishtahir.com) 插件后即可查看波形： -->
<p>Install <a href="https://marketplace.visualstudio.com/items?itemName=wavetrace.wavetrace&amp;ref=nishtahir.com">Wavetrace</a> in vscode to view the waveform:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="wave-in-vscode.png" class="img-fluid figure-img"></p>
<figcaption>Display the waveform in vscode</figcaption>
</figure>
</div>
<!-- 也可以用 [gtkwave](https://saiankit.medium.com/how-to-simulate-verilog-models-on-macos-5a6f821b2c4f) 软件内查看波形： -->
<p>You can also install <a href="https://saiankit.medium.com/how-to-simulate-verilog-models-on-macos-5a6f821b2c4f">gtkwave</a> to view the waveform.</p>
<pre><code>brew install gtkwave
gtkwave GatedDLatch_tb.vcd</code></pre>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="gtkwave1.png" class="img-fluid figure-img"></p>
<figcaption>Before imported</figcaption>
</figure>
</div>
<!-- 下拉 GatedDLatch_tb 列表可显示波形： -->
<p>Expand GatedDLatch_tb list to display the waveform:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="gtkwave2.png" class="img-fluid figure-img"></p>
<figcaption>Displaying waveform</figcaption>
</figure>
</div>
</section>
<section id="synthesis-and-visualization" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="synthesis-and-visualization"><span class="header-section-number">2.3</span> Synthesis and Visualization</h3>
<!-- 我们需要将画出来的电路拓扑可视化（产生Schematics），首先用 `YoSYS` 将 Verilog 代码转化为数字逻辑电路的门级网表 (gate-level netlist)，先安装 `YoSYS`: -->
<p>We can also visualize the circuit topology (called generating schematics). First, use <code>YoSYS</code> to convert the verilog code into gate-level netlist. Of course you should install the command line tool <code>YoSYS</code>:</p>
<pre><code>brew install yosys
yosys -V # Verify Yosys installation</code></pre>
<!-- `YoSYS` 可将电路结构文件 `GatedDLatch.v` 转换为一个 `json` 文件： -->
<p><code>YoSYS</code> will first convert the circuit structure description file <code>GatedDLatch.v</code> into a <code>json</code> file:</p>
<pre><code>yosys -p "prep -top GatedDLatch; write_json GatedDLatch.json" GatedDLatch.v</code></pre>
<!-- 然后我们再安装 `netlistsvg` 工具: -->
<p>Then we install another tool called <code>netlistsvg</code>:</p>
<pre><code># Install Node.js (if not already installed)
brew install node

# Install netlistsvg globally using npm
npm install -g netlistsvg

# Verify netlistsvg installation
netlistsvg --version</code></pre>
<!-- 用 `netlistsvg` 工具将 `GatedDLatch.json` 转换为 `GatedDLatch.svg`: -->
<p>Using the <code>netlistsvg</code> tool to convert <code>GatedDLatch.json</code> to <code>GatedDLatch.svg</code>:</p>
<pre><code>netlistsvg GatedDLatch.json -o GatedDLatch.svg</code></pre>
<!-- 预览 `GatedDLatch.svg` 可得电路结构图： -->
<p>Previewing GatedDLatch.svg will give you the circuit schematic:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="GatedDLatch.png" class="img-fluid figure-img"></p>
<figcaption><code>GatedDLatch.svg</code></figcaption>
</figure>
</div>
</section>
<section id="makefile-work-flow" class="level3" data-number="2.4">
<h3 data-number="2.4" class="anchored" data-anchor-id="makefile-work-flow"><span class="header-section-number">2.4</span> Makefile Work Flow</h3>
<!-- 可见整个流程分为上述独立的两大块： -->
<p>The entire workflow can be divided into two major independent parts:</p>
<!-- * 编译、仿真
    * `iverilog` (Compilation)
    * `vvp` (Simulation)
* 合成、电路结构可视化
    * `yosys` (Synthesis)
    * `netlistsvg` (Visualization) -->
<ul>
<li>Compilation and Simulation:
<ul>
<li><code>iverilog</code> (Compilation)</li>
<li><code>vvp</code> (Simulation)</li>
</ul></li>
<li>Synthesis and Circuit Structure Visualization:
<ul>
<li><code>yosys</code> (Synthesis)</li>
<li><code>netlistsvg</code> (Visualization)</li>
</ul></li>
</ul>
<!-- 我们用 Makefile 自动化这个过程（确保你装了Make有关组件）：在之前建的 `Verilog` 文件夹下创建一个 `Makefile` 文件，加入以下内容： -->
<p>We use a Makefile to automate this process (ensure that Make and related components are installed): Create a <code>Makefile</code> file in the previously created <code>Verilog</code> folder and add the following content:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode makefile code-with-copy"><code class="sourceCode makefile"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Description: Makefile for GatedDLatch</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="dt">CIRCUIT_STRUCT</span> <span class="ch">=</span><span class="st"> GatedDLatch</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Directories</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="dt">BUILD_DIR</span> <span class="ch">=</span><span class="st"> build</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure the build directory exists</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="dv">$(BUILD_DIR):</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="er">    </span>mkdir -p <span class="ch">$(</span><span class="dt">BUILD_DIR</span><span class="ch">)</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Compilation: iverilog compilation</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="dv">iverilog:</span><span class="dt"> </span><span class="ch">$(</span><span class="dt">CIRCUIT_STRUCT</span><span class="ch">)</span><span class="dt">.v </span><span class="ch">$(</span><span class="dt">CIRCUIT_STRUCT</span><span class="ch">)</span><span class="dt">_tb.v | </span><span class="ch">$(</span><span class="dt">BUILD_DIR</span><span class="ch">)</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="er">    </span>iverilog -o <span class="ch">$(</span><span class="dt">BUILD_DIR</span><span class="ch">)</span>/<span class="ch">$(</span><span class="dt">CIRCUIT_STRUCT</span><span class="ch">)</span>_tb.vvp <span class="ch">$(</span><span class="dt">CIRCUIT_STRUCT</span><span class="ch">)</span>_tb.v</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulation: generate waveform (.vcd)</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="dv">vvp:</span><span class="dt"> </span><span class="ch">$(</span><span class="dt">BUILD_DIR</span><span class="ch">)</span><span class="dt">/</span><span class="ch">$(</span><span class="dt">CIRCUIT_STRUCT</span><span class="ch">)</span><span class="dt">_tb.vvp</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="er">    </span>vvp <span class="ch">$(</span><span class="dt">BUILD_DIR</span><span class="ch">)</span>/<span class="ch">$(</span><span class="dt">CIRCUIT_STRUCT</span><span class="ch">)</span>_tb.vvp</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Synthesis: generate circuit structure configuration file (.json)</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="dv">YOSYS:</span><span class="dt"> </span><span class="ch">$(</span><span class="dt">CIRCUIT_STRUCT</span><span class="ch">)</span><span class="dt">.v | </span><span class="ch">$(</span><span class="dt">BUILD_DIR</span><span class="ch">)</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="er">    </span>yosys -p <span class="st">"prep -top </span><span class="ch">$(</span><span class="dt">CIRCUIT_STRUCT</span><span class="ch">)</span><span class="st">; write_json </span><span class="ch">$(</span><span class="dt">BUILD_DIR</span><span class="ch">)</span><span class="st">/</span><span class="ch">$(</span><span class="dt">CIRCUIT_STRUCT</span><span class="ch">)</span><span class="st">.json"</span> <span class="ch">$(</span><span class="dt">CIRCUIT_STRUCT</span><span class="ch">)</span>.v</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization: generate human readable (.svg) from .json</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="dv">NETLISTSVG:</span><span class="dt"> </span><span class="ch">$(</span><span class="dt">BUILD_DIR</span><span class="ch">)</span><span class="dt">/</span><span class="ch">$(</span><span class="dt">CIRCUIT_STRUCT</span><span class="ch">)</span><span class="dt">.json | </span><span class="ch">$(</span><span class="dt">BUILD_DIR</span><span class="ch">)</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="er">    </span>netlistsvg <span class="ch">$(</span><span class="dt">BUILD_DIR</span><span class="ch">)</span>/<span class="ch">$(</span><span class="dt">CIRCUIT_STRUCT</span><span class="ch">)</span>.json -o <span class="ch">$(</span><span class="dt">BUILD_DIR</span><span class="ch">)</span>/<span class="ch">$(</span><span class="dt">CIRCUIT_STRUCT</span><span class="ch">)</span>.svg</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Schematic diagram only: Synthesis then Visualization</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a><span class="dv">schematic:</span><span class="dt"> YOSYS NETLISTSVG</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Run all steps</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a><span class="dv">run_all:</span><span class="dt"> iverilog vvp schematic</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean build directory</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a><span class="dv">clean:</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a><span class="er">    </span>rm -rf <span class="ch">$(</span><span class="dt">BUILD_DIR</span><span class="ch">)</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>    rm -f <span class="ch">$(</span><span class="dt">CIRCUIT_STRUCT</span><span class="ch">)</span>_tb.vcd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<!-- 每次改变文件后只需执行： -->
<p>After modifying the files, simply execute:</p>
<pre><code>make clean
make run_all</code></pre>
<!-- 即可生成所有相关文件： -->
<p>This will generate all the relevant files:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="inside-verilog.png" class="img-fluid figure-img"></p>
<figcaption>Project File Structure</figcaption>
</figure>
</div>
</section>
</section>
<section id="first-project-in-vhdl" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="first-project-in-vhdl"><span class="header-section-number">3</span> First Project in VHDL</h2>
<section id="install-ghdl-compiler" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="install-ghdl-compiler"><span class="header-section-number">3.1</span> Install GHDL Compiler</h3>
<!-- 和 Verilog 一样，VHDL 也是一种硬件描述语言。编译它需要另一个工具：[GHDL](https://github.com/ghdl/ghdl?tab=readme-ov-file). 在MacOS上安装它有几个坑，以下步骤在M2 Mac上实测有效（截止2024-09-01）： -->
<p>Similar to Verilog, VHDL is also a hardware description language. Compiling it requires another tool: <a href="https://github.com/ghdl/ghdl?tab=readme-ov-file">GHDL</a>. Installing it on macOS can be tricky. The following steps have been tested on an M2 Mac (as of 2024-09-01):</p>
<!-- 用 `brew` 安装`vhdl`: -->
<p>Install <code>vhdl</code> using <code>brew</code>:</p>
<pre><code>brew install vhdl</code></pre>
<!-- `vhdl` 有两个版本：LLVM和mcode，LLVM版本在Mac上有点问题，而brew下载的正是这个版本，所以我们从[这里](https://github.com/ghdl/ghdl/releases/tag/nightly)手动下载mcode的组件，我下的是 `ghdl-macos-11-mcode.tgz`。 -->
<p><code>vhdl</code> has two versions: LLVM and mcode. The LLVM version has some issues on macOS, and the brew-installed version uses LLVM, so we manually download the mcode version from <a href="https://github.com/ghdl/ghdl/releases/tag/nightly">here</a>. I downloaded ghdl-macos-11-mcode.tgz.</p>
<p>Extract it by double-clicking, and you will get three files:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ghdl-package.png" class="img-fluid figure-img"></p>
<figcaption>GHDL-mcode package</figcaption>
</figure>
</div>
<!-- 将这三个文件复制粘贴到这个路径：`/opt/homebrew/Caskroom/ghdl/4.1.0`: -->
<p>Copy and paste these three files to the following path: <code>/opt/homebrew/Caskroom/ghdl/4.1.0</code>:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="copy-and-paste.png" class="img-fluid figure-img"></p>
<figcaption>Copy and Paste</figcaption>
</figure>
</div>
<p>In the terminal, type:</p>
<pre><code>ghdl --version</code></pre>
<!-- 如果有安全性提示，到系统设置 Privacy & Security 中允许即可: -->
<p>If you encounter security prompts, go to System Settings &gt; Privacy &amp; Security to allow access:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="settings.png" class="img-fluid figure-img"></p>
<figcaption>Allow Access in Privacy &amp; Security</figcaption>
</figure>
</div>
</section>
<section id="compilation-linking-and-simulation" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="compilation-linking-and-simulation"><span class="header-section-number">3.2</span> Compilation, Linking and Simulation</h3>
<!-- 与Verilog不同，VHDL多了一步Linking，就是将component声明和其实体文件 (testbench) 链接在一起。Verilog为什么不要这一步？因为testbench文件中包含了声明的内容 (`include "GatedDLatch.v" `)，可自动链接。 -->
<p>Unlike Verilog, VHDL requires an additional Linking step, which connects the component declarations with their implementation files (testbench). Why doesn’t Verilog require this? Because the testbench file in Verilog includes the declaration contents (<code>include "GatedDLatch.v"</code>), so it links automatically.</p>
<!-- Verilog 中我们用了两中不同的工具 (`iverilog`, `vvp`) 来完成编译和仿真。而VHDL只用一个工具：`GHDL`. -->
<p>In Verilog, we used two separate tools (<code>iverilog</code> and <code>vvp</code>) for compilation and simulation. However, for VHDL, we only need one tool: <code>GHDL</code>.</p>
<!-- 新建文件夹`VHDLDemo`，在其中新建两个测试文件：`demo.vhdl` and `demo_tb.vhdl`，前者为电路结构描述文件，后者为testbench文件 (也可用`.vhd`为后缀)，分别写入以下内容： -->
<p>Create a new folder <code>VHDLDemo</code>, and within it, create two files: <code>demo.vhdl</code> and <code>demo_tb.vhdl</code>. The former describes the circuit structure, and the latter serves as the testbench file (you can also use <code>.vhd</code> as the suffix). Add the following content to the respective files:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode vhdl code-with-copy"><code class="sourceCode vhdl"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">library</span> IEEE;</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> IEEE<span class="ot">.</span>STD_LOGIC_1164<span class="ot">.</span><span class="kw">ALL</span>;</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">demo</span> <span class="kw">is</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span> (</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>        A <span class="ot">:</span> <span class="kw">in</span>  <span class="dt">STD_LOGIC</span>;</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>        B <span class="ot">:</span> <span class="kw">in</span>  <span class="dt">STD_LOGIC</span>;</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>        O <span class="ot">:</span> <span class="kw">out</span> <span class="dt">STD_LOGIC</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    );</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="cf">end demo;</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">Behavioral</span> <span class="kw">of</span> <span class="fu">demo</span> <span class="kw">is</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    O <span class="ot">&lt;=</span> <span class="kw">not</span> (A <span class="kw">and</span> B); <span class="co">-- NAND gate</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="cf">end Behavioral;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>and</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode vhdl code-with-copy"><code class="sourceCode vhdl"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">library</span> IEEE;</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> IEEE<span class="ot">.</span>STD_LOGIC_1164<span class="ot">.</span><span class="kw">ALL</span>;</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">demo_tb</span> <span class="kw">is</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="cf">end demo_tb;</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">Behavioral</span> <span class="kw">of</span> <span class="fu">demo_tb</span> <span class="kw">is</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="ot">signal</span> A <span class="ot">:</span> <span class="dt">STD_LOGIC</span> <span class="ot">:=</span> <span class="bn">'0'</span>;</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="ot">signal</span> B <span class="ot">:</span> <span class="dt">STD_LOGIC</span> <span class="ot">:=</span> <span class="bn">'0'</span>;</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    <span class="ot">signal</span> O <span class="ot">:</span> <span class="dt">STD_LOGIC</span>;</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">-- Instantiate the unit under test (UUT)</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">component</span> <span class="dv">demo</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">port</span> (</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>            A <span class="ot">:</span> <span class="kw">in</span>  <span class="dt">STD_LOGIC</span>;</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>            B <span class="ot">:</span> <span class="kw">in</span>  <span class="dt">STD_LOGIC</span>;</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>            O <span class="ot">:</span> <span class="kw">out</span> <span class="dt">STD_LOGIC</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>        );</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end component;</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>    <span class="dv">UUT</span><span class="ot">:</span> <span class="fu">demo</span> <span class="kw">port map </span>(</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>        A <span class="ot">=&gt;</span> A<span class="ot">,</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>        B <span class="ot">=&gt;</span> B<span class="ot">,</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>        O <span class="ot">=&gt;</span> O</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>    );</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>    <span class="co">-- Test process</span></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>    <span class="sc">process</span></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>    <span class="sc">begin</span></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>        <span class="co">-- Test case 1: A = 0, B = 0</span></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>        A <span class="ot">&lt;=</span> <span class="bn">'0'</span>;</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>        B <span class="ot">&lt;=</span> <span class="bn">'0'</span>;</span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>        <span class="kw">wait</span> <span class="kw">for</span> <span class="dv">10</span> <span class="dt">ns</span>;</span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>        <span class="co">-- Test case 2: A = 0, B = 1</span></span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>        A <span class="ot">&lt;=</span> <span class="bn">'0'</span>;</span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>        B <span class="ot">&lt;=</span> <span class="bn">'1'</span>;</span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>        <span class="kw">wait</span> <span class="kw">for</span> <span class="dv">10</span> <span class="dt">ns</span>;</span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>        <span class="co">-- Test case 3: A = 1, B = 0</span></span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>        A <span class="ot">&lt;=</span> <span class="bn">'1'</span>;</span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>        B <span class="ot">&lt;=</span> <span class="bn">'0'</span>;</span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a>        <span class="kw">wait</span> <span class="kw">for</span> <span class="dv">10</span> <span class="dt">ns</span>;</span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a>        <span class="co">-- Test case 4: A = 1, B = 1</span></span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a>        A <span class="ot">&lt;=</span> <span class="bn">'1'</span>;</span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a>        B <span class="ot">&lt;=</span> <span class="bn">'1'</span>;</span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a>        <span class="kw">wait</span> <span class="kw">for</span> <span class="dv">10</span> <span class="dt">ns</span>;</span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a>        <span class="co">-- End of simulation</span></span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a>        <span class="kw">wait</span>;</span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a>    <span class="sc">end process;</span></span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a><span class="cf">end Behavioral;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<!-- 再建立一个 `Makefile` 文件实现自动化： -->
<p>Create a <code>Makefile</code> to automate the process:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode makefile code-with-copy"><code class="sourceCode makefile"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Description: Makefile for VHDLDemo</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="dt">CIRCUIT</span> <span class="ch">=</span><span class="st"> demo</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="dt">TB</span> <span class="ch">=</span><span class="st"> demo_tb</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="dt">BUILD_DIR</span> <span class="ch">=</span><span class="st"> build</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure the build directory exists</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="dv">$(BUILD_DIR):</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="er">    </span>mkdir -p <span class="ch">$(</span><span class="dt">BUILD_DIR</span><span class="ch">)</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Compilation: compile the design and testbench</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="dv">ghdl_compile:</span><span class="dt"> </span><span class="ch">$(</span><span class="dt">BUILD_DIR</span><span class="ch">)</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="er">    </span>ghdl -a --workdir=<span class="ch">$(</span><span class="dt">BUILD_DIR</span><span class="ch">)</span> <span class="ch">$(</span><span class="dt">CIRCUIT</span><span class="ch">)</span>.vhdl</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    ghdl -a --workdir=<span class="ch">$(</span><span class="dt">BUILD_DIR</span><span class="ch">)</span> <span class="ch">$(</span><span class="dt">TB</span><span class="ch">)</span>.vhdl</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Linking: Elaborate the design and testbench</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="dv">ghdl_elab:</span><span class="dt"> ghdl_compile</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="er">    </span>ghdl -e --workdir=<span class="ch">$(</span><span class="dt">BUILD_DIR</span><span class="ch">)</span> <span class="ch">$(</span><span class="dt">TB</span><span class="ch">)</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulation: simulate the testbench</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="dv">ghdl_simulate:</span><span class="dt"> ghdl_elab</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a><span class="er">    </span>ghdl -r --workdir=<span class="ch">$(</span><span class="dt">BUILD_DIR</span><span class="ch">)</span> <span class="ch">$(</span><span class="dt">TB</span><span class="ch">)</span> --vcd=<span class="ch">$(</span><span class="dt">BUILD_DIR</span><span class="ch">)</span>/<span class="ch">$(</span><span class="dt">TB</span><span class="ch">)</span>.vcd</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a><span class="co">### These cannot work for now##############################################</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a><span class="co"># # Synthesis: generate circuit structure configuration file (.json), you should have ghdl plugin installed for yosys, but I have error: "ERROR: No such command: ghdl" or "dyld[5264]: missing symbol called", possible solution could be to install yosys from source, but not sure</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a><span class="co"># YOSYS: $(CIRCUIT).vhdl | $(BUILD_DIR)</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a><span class="co">#   yosys -p "ghdl $(CIRCUIT); prep -top $(CIRCUIT); write_json -compat-int $(BUILD_DIR)/$(CIRCUIT).json" $(CIRCUIT).vhdl</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a><span class="co"># # Visualization: generate human readable (.svg) from .json</span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a><span class="co"># NETLISTSVG: $(BUILD_DIR)/$(CIRCUIT).json  | $(BUILD_DIR)</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a><span class="co">#   netlistsvg $(BUILD_DIR)/$(CIRCUIT).json -o $(BUILD_DIR)/$(CIRCUIT).svg</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a><span class="co"># # Schematic diagram only: Synthesis then Visualization</span></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a><span class="co"># schematic: YOSYS NETLISTSVG</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a><span class="co"># # Run all steps</span></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a><span class="co"># run_all: ghdl_compile ghdl_elab ghdl_simulate YOSYS NETLISTSVG</span></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a><span class="co">### These cannot work for now##############################################</span></span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Run compilation, linking and simulation</span></span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a><span class="dv">run_cls:</span><span class="dt"> ghdl_compile ghdl_elab ghdl_simulate</span></span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean build directory</span></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a><span class="dv">clean:</span></span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a><span class="er">    </span>rm -rf <span class="ch">$(</span><span class="dt">BUILD_DIR</span><span class="ch">)</span></span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>    rm -f <span class="ch">$(</span><span class="dt">TB</span><span class="ch">)</span></span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Experiment: Run testbench without the design file</span></span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a><span class="dv">run_tb_only:</span><span class="dt"> </span><span class="ch">$(</span><span class="dt">BUILD_DIR</span><span class="ch">)</span></span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a><span class="er">    </span>ghdl -a --workdir=<span class="ch">$(</span><span class="dt">BUILD_DIR</span><span class="ch">)</span> <span class="ch">$(</span><span class="dt">TB</span><span class="ch">)</span>.vhdl</span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>    ghdl -r --workdir=<span class="ch">$(</span><span class="dt">BUILD_DIR</span><span class="ch">)</span> <span class="ch">$(</span><span class="dt">TB</span><span class="ch">)</span> --vcd=<span class="ch">$(</span><span class="dt">BUILD_DIR</span><span class="ch">)</span>/<span class="ch">$(</span><span class="dt">TB</span><span class="ch">)</span>_no_design.vcd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<!-- 运行过程自行理解。命令行执行： -->
<p>The running process is very clear. In the command line, execute:</p>
<pre><code>make clean
make run_cls</code></pre>
<!-- 即可。 -->
<p>This will complete the process.</p>
<!-- 如果你要看如果不编译链接 design file (`demo.vhdl`) 会出来什么，可以运行： -->
<p>If you want to see what happens if you skip compiling and linking the design file (<code>demo.vhdl</code>), run:</p>
<pre><code>make clean # Cannot omitted!
make run_tb_only</code></pre>
<!-- 你可以在vscode中或用gtkwave对比两次生成的 `.vcd` 文件，它们是有区别的。 -->
<p>You can compare the two <code>.vcd</code> files generated in VSCode or using GTKWave; they are different as expected.</p>
</section>
<section id="no-synthesis-and-visualization-plan" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="no-synthesis-and-visualization-plan"><span class="header-section-number">3.3</span> No Synthesis and Visualization Plan</h3>
<!-- 注意这个 `Makefile` 没有包括画schematic diagram, 因为 `yosys` 需要装 `ghdl` 插件，目前适配不是很好，具体可参考 [ghdl-yosys-plugin](https://github.com/ghdl/ghdl-yosys-plugin?tab=readme-ov-file), [building-ghdl](https://ghdl.github.io/ghdl/development/building/index.html), 前者提到的方法在M2 Mac上已经试过，会报错： -->
<p>Note that this <code>Makefile</code> does not include steps to generate a schematic diagram because <code>yosys</code> requires a <code>ghdl</code> plugin. Currently, the integration is not very stable. You can refer to <a href="https://github.com/ghdl/ghdl-yosys-plugin?tab=readme-ov-file">ghdl-yosys-plugin</a> and <a href="https://ghdl.github.io/ghdl/development/building/index.html">building-ghdl</a> for more details. However, the suggested methods have been tested on M2 Mac and result in errors:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a> <span class="ex">/----------------------------------------------------------------------------</span><span class="dt">\</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a> <span class="kw">|</span>  <span class="ex">yosys</span> <span class="at">--</span> Yosys Open SYnthesis Suite                                       <span class="kw">|</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a> <span class="kw">|</span>  <span class="ex">Copyright</span> <span class="er">(</span><span class="ex">C</span><span class="kw">)</span> <span class="ex">2012</span> <span class="at">-</span> 2024  Claire Xenia Wolf <span class="op">&lt;</span>claire@yosyshq.com<span class="op">&gt;</span>         <span class="kw">|</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a> <span class="kw">|</span>  <span class="ex">Distributed</span> under an ISC-like license, type <span class="st">"license"</span> to see terms        <span class="kw">|</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a> <span class="ex">\----------------------------------------------------------------------------/</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a> <span class="ex">Yosys</span> 0.44 <span class="er">(</span><span class="fu">git</span> sha1 80ba43d26, clang++ 15.0.0 <span class="at">-fPIC</span> <span class="at">-O3</span><span class="kw">)</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="ex">--</span> Running command <span class="kw">`</span><span class="ex">ghdl</span> demo_tb.vhdl <span class="at">-e</span> demo_tb<span class="kw">;</span> <span class="ex">prep</span> <span class="at">-top</span> demo_tb<span class="kw">;</span> <span class="ex">write_json</span> demo.json<span class="st">' --</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="st">1. Executing GHDL.</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="st">dyld[5264]: missing symbol called</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="st">zsh: abort      yosys -m ghdl -p</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<!-- 这个问题在 [ghdl-yosys-plugin](https://github.com/ghdl/ghdl-yosys-plugin?tab=readme-ov-file) 的 Issues 里面也有人问了，没答案。 -->
<p>This issue has also been mentioned in the Issues section of <a href="https://github.com/ghdl/ghdl-yosys-plugin?tab=readme-ov-file">ghdl-yosys-plugin</a>, but there is no solution yet.</p>
<!-- 可能的解决方法是从[源文件](https://github.com/YosysHQ/yosys)自行编译安装`yosys`，或者 `yosys` 或 `ghdl` 的版本不对，或缺少了[工具链](https://github.com/YosysHQ/fpga-toolchain)中的某个工具。或者用某个工具将 `VHDL` 转成 `Verilog` 后再合成 Schematics. -->
<p>Possible solutions might include compiling and installing yosys from <a href="https://github.com/YosysHQ/yosys">source</a>, ensuring the correct versions of <code>yosys</code> and <code>ghdl</code>, or checking if any component of the FPGA <a href="https://github.com/YosysHQ/fpga-toolchain">Toolchain</a> is missing. Alternatively, you could try converting <code>VHDL</code> to <code>Verilog</code> using some tool (like GPT) and then synthesizing the schematics.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/marcobisky\.github\.io");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="Marcobisky.github.io" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© Copyright 2025 Marcobisky.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>