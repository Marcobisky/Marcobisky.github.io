`Pybind11` 是一个 `C++` 库, 使得我们可以在 `Python` 代码中调用 `C++` 函数和类. 比如:

::: {layout-ncol=2}
```{.cpp filename="add_op.cpp" #lst-addopcpp}
{{< include src/pybind/add_op.cpp >}}
```

```{.python filename="main.py" #lst-mainpy}
{{< include src/pybind/main.py >}}
```
:::

@lst-addopcpp 中第一个 `add` 是 Python 里调用用的函数名, 第二个是 C++ 里的函数名. `ops` 和 `m` 也可以换成任意别的名字. 运行类似下面的命令:

```bash
c++ -O3 -Wall -shared -std=c++11 -fPIC -undefined dynamic_lookup \
    -I/opt/homebrew/anaconda3/lib/python3.12/site-packages/pybind11/include \
    -I/opt/homebrew/anaconda3/include/python3.12 \
    add_op.cpp -o ops.cpython-312-darwin.so

python main.py # output 8
```

第一个命令会在当前目录下产生一个 `.so` (shared object) 文件. 运行 `python main.py` 的时候在 `import ops` 的时候, `Python` 会在 `.so` 文件中找到 `add` 函数.
