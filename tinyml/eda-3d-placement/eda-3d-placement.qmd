---
title: "EDA: 3D IC Placement"
---

## Environment Setup (MacOS)

Clone 仓库:

```bash
git clone <repository-url>
git submodule update --init --recursive
```

创建 `Python` 环境:

```bash
conda create -n cupid python=3.9
conda activate cupid
pip install torch torchvision torchaudio
pip install pyunpack patool matplotlib cairocffi pkgconfig scipy
pip install "numpy>=1.15.4,<2.0"
pip install setuptools
mkdir -p build
cd build
```

安装 `openMP` 支持:

```bash
brew install libomp
brew --prefix libomp
export OpenMP_ROOT=/opt/homebrew/opt/libomp
export OpenMP_CXX_FLAGS="-Xpreprocessor -fopenmp -I/opt/homebrew/opt/libomp/include"
export OpenMP_CXX_LIB_NAMES="omp"
export OpenMP_omp_LIBRARY=/opt/homebrew/opt/libomp/lib/libomp.dylib
```

安装 `bison`:

```bash
brew install bison
```

## Introduction

### Model


## Question 11.23

- Placement 的原问题是给定 Netlist $(V, E)$, 输出所有 pin 的位置坐标. 那实际走线的话在水平方向只能横竖着走, 不能斜着走. Bistratal wirelength 模型中好像只考虑了上下 die 的线长, $z$ 轴方向的线长没有考虑吗?:

    ![alt text](image.png)

    ![alt text](image-2.png)

    (Eq (25) 后面那一项看上去考虑了 $z$ 轴方向的线长, 实际上是为了减少 HBT 的数量.)

- 如果一个 net 是 split net, 那需要增加一个 HBT 来连接上下 die, 这个 HBT 的位置是随机在 optimal region $B^*_{e, \text{HBT}}$ 里面选的吗? 

- 在优化过程中 HBT 的数量应该是会变的吧 (因为有些 net 可能会从 split net 变成 non-split net), 那相当于这个优化问题的自变量的数量都会随着优化过程变化?

- $z$ 轴方向的垂直联通实际上是怎样的? 是有很多层可以来连线吗? 就像下图的红色圈起来的灰色方块?

    ![alt text](image-1.png)

- 根据上图, 每个 cell (或 pin) 只能在上 die 或者下 die, 但是论文里面 (Eq (25)) 都是建模成 pin 的 $z$ 也是连续变化的, 最后优化出来的 pin 应该是连续分布在上下 die 之间的, 最后是直接按照 tentative partition 的方法直接把浮在中间的 pin 分成两类, 然后分别垂直投影到上下 die 上吗?

## Question 11.24

- PlaceDB.py: xl, xh, yl, yh meaning?
- movable nodes, terminals, terminal_NIs, and fillers? (Filler cells meaning?)
- PlaceDB.py: regions? FENCE, GUIDE?
- cell 和 pin 的关系是一个 cell 可以有多个 pin, 而且这些 pin 的 location 由 pin offset 决定?